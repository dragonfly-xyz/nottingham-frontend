import{s as Se,o as ce,p as G,k as b,i as d,b as j,e as L,j as M,d as V,q as we,f as C,v as U,B as Pe,t as $,h as g,l as h,m as A,n as Ee}from"../chunks/scheduler.C1FoT2GD.js";import{S as Te,i as Le,c as Q,b as J,m as K,t as z,a as B,d as W,g as ne,e as ae}from"../chunks/index.DFmxPlw4.js";import{e as Y,u as Ve,o as Ce}from"../chunks/each.Bmx-BImQ.js";import{b as _e}from"../chunks/paths.DOnYZ1f4.js";import{p as je}from"../chunks/stores.ZuLyBo9H.js";import{a as Me,U as re,P as Ne,i as ze,c as He,g as me,j as de,f as pe}from"../chunks/kit.B5hTzwHX.js";import{P as Ae,L as Be,C as Ie}from"../chunks/page.CWCv2ozC.js";import{P as Ue}from"../chunks/player.rNBuc2kc.js";import{S as Fe}from"../chunks/contest.BdJ2gSqk.js";function he(n,e,t){const l=n.slice();return l[7]=e[t],l[9]=t,l}function ve(n,e,t){const l=n.slice();return l[10]=e[t],l[9]=t,l}function Re(n){let e,t,l,r="Tournaments",f,a,i;e=new Be({props:{$$slots:{default:[Je]},$$scope:{ctx:n}}});let o=Y(n[1]),u=[];for(let s=0;s<o.length;s+=1)u[s]=De(he(n,o,s));const _=s=>B(u[s],1,1,()=>{u[s]=null});return{c(){Q(e.$$.fragment),t=j(),l=L("h2"),l.textContent=r,f=j(),a=L("div");for(let s=0;s<u.length;s+=1)u[s].c();this.h()},l(s){J(e.$$.fragment,s),t=M(s),l=V(s,"H2",{class:!0,"data-svelte-h":!0}),we(l)!=="svelte-efgyhy"&&(l.textContent=r),f=M(s),a=V(s,"DIV",{class:!0});var c=C(a);for(let k=0;k<u.length;k+=1)u[k].l(c);c.forEach(d),this.h()},h(){U(l,"class","svelte-j2bsx1"),U(a,"class","grid svelte-j2bsx1")},m(s,c){K(e,s,c),b(s,t,c),b(s,l,c),b(s,f,c),b(s,a,c);for(let k=0;k<u.length;k+=1)u[k]&&u[k].m(a,null);i=!0},p(s,c){const k={};if(c&4101&&(k.$$scope={dirty:c,ctx:s}),e.$set(k),c&3){o=Y(s[1]);let y;for(y=0;y<o.length;y+=1){const D=he(s,o,y);u[y]?(u[y].p(D,c),z(u[y],1)):(u[y]=De(D),u[y].c(),z(u[y],1),u[y].m(a,null))}for(ne(),y=o.length;y<u.length;y+=1)_(y);ae()}},i(s){if(!i){z(e.$$.fragment,s);for(let c=0;c<o.length;c+=1)z(u[c]);i=!0}},o(s){B(e.$$.fragment,s),u=u.filter(Boolean);for(let c=0;c<u.length;c+=1)B(u[c]);i=!1},d(s){s&&(d(t),d(l),d(f),d(a)),W(e,s),Pe(u,s)}}}function qe(n){let e,t,l,r=me(n[1])+"",f,a;return e=new Ie({props:{failed:!0}}),{c(){Q(e.$$.fragment),t=j(),l=L("div"),f=$(r),this.h()},l(i){J(e.$$.fragment,i),t=M(i),l=V(i,"DIV",{class:!0});var o=C(l);f=g(o,r),o.forEach(d),this.h()},h(){U(l,"class","error")},m(i,o){K(e,i,o),b(i,t,o),b(i,l,o),h(l,f),a=!0},p(i,o){(!a||o&2)&&r!==(r=me(i[1])+"")&&A(f,r)},i(i){a||(z(e.$$.fragment,i),a=!0)},o(i){B(e.$$.fragment,i),a=!1},d(i){i&&(d(t),d(l)),W(e,i)}}}function Ge(n){let e,t,l;return t=new Ie({}),{c(){e=L("div"),Q(t.$$.fragment),this.h()},l(r){e=V(r,"DIV",{class:!0});var f=C(e);J(t.$$.fragment,f),f.forEach(d),this.h()},h(){U(e,"class","loading")},m(r,f){b(r,e,f),K(t,e,null),l=!0},p:Ee,i(r){l||(z(t.$$.fragment,r),l=!0)},o(r){B(t.$$.fragment,r),l=!1},d(r){r&&d(e),W(t)}}}function Oe(n){let e;return{c(){e=$("Progress")},l(t){e=g(t,"Progress")},m(t,l){b(t,e,l)},d(t){t&&d(e)}}}function Qe(n){let e;return{c(){e=$("Summary")},l(t){e=g(t,"Summary")},m(t,l){b(t,e,l)},d(t){t&&d(e)}}}function ke(n){var f;let e,t,l=((f=n[2][n[0]].closedTime)==null?void 0:f.toLocaleDateString())+"",r;return{c(){e=L("div"),t=$("Ended on: "),r=$(l)},l(a){e=V(a,"DIV",{});var i=C(e);t=g(i,"Ended on: "),r=g(i,l),i.forEach(d)},m(a,i){b(a,e,i),h(e,t),h(e,r)},p(a,i){var o;i&5&&l!==(l=((o=a[2][a[0]].closedTime)==null?void 0:o.toLocaleDateString())+"")&&A(r,l)},d(a){a&&d(e)}}}function $e(n){let e,t,l=de(n[2][n[0]].prize)+"",r,f;return{c(){e=L("div"),t=$("Prize: "),r=$(l),f=$(" ETH")},l(a){e=V(a,"DIV",{});var i=C(e);t=g(i,"Prize: "),r=g(i,l),f=g(i," ETH"),i.forEach(d)},m(a,i){b(a,e,i),h(e,t),h(e,r),h(e,f)},p(a,i){i&5&&l!==(l=de(a[2][a[0]].prize)+"")&&A(r,l)},d(a){a&&d(e)}}}function Je(n){var q,F;let e,t,l=n[0]+1+"",r,f,a,i,o,u=n[2][n[0]].startTime.toLocaleDateString()+"",_,s,c,k;function y(m,E){var T;return((T=m[2][m[0]])==null?void 0:T.state)===Fe.Revealed?Qe:Oe}let D=y(n),w=D(n),S=((q=n[2][n[0]])==null?void 0:q.closedTime)&&ke(n),I=((F=n[2][n[0]])==null?void 0:F.prize)>0n&&$e(n);return{c(){e=L("h1"),t=$("Season "),r=$(l),f=j(),w.c(),a=j(),i=L("div"),o=$("Started on "),_=$(u),s=j(),S&&S.c(),c=j(),I&&I.c(),k=G(),this.h()},l(m){e=V(m,"H1",{class:!0});var E=C(e);t=g(E,"Season "),r=g(E,l),f=M(E),w.l(E),E.forEach(d),a=M(m),i=V(m,"DIV",{});var T=C(i);o=g(T,"Started on "),_=g(T,u),T.forEach(d),s=M(m),S&&S.l(m),c=M(m),I&&I.l(m),k=G(),this.h()},h(){U(e,"class","svelte-j2bsx1")},m(m,E){b(m,e,E),h(e,t),h(e,r),h(e,f),w.m(e,null),b(m,a,E),b(m,i,E),h(i,o),h(i,_),b(m,s,E),S&&S.m(m,E),b(m,c,E),I&&I.m(m,E),b(m,k,E)},p(m,E){var T,P;E&1&&l!==(l=m[0]+1+"")&&A(r,l),D!==(D=y(m))&&(w.d(1),w=D(m),w&&(w.c(),w.m(e,null))),E&5&&u!==(u=m[2][m[0]].startTime.toLocaleDateString()+"")&&A(_,u),(T=m[2][m[0]])!=null&&T.closedTime?S?S.p(m,E):(S=ke(m),S.c(),S.m(c.parentNode,c)):S&&(S.d(1),S=null),((P=m[2][m[0]])==null?void 0:P.prize)>0n?I?I.p(m,E):(I=$e(m),I.c(),I.m(k.parentNode,k)):I&&(I.d(1),I=null)},d(m){m&&(d(e),d(a),d(i),d(s),d(c),d(k)),w.d(),S&&S.d(m),I&&I.d(m)}}}function Ke(n){let e;return{c(){e=$("Grand Faire")},l(t){e=g(t,"Grand Faire")},m(t,l){b(t,e,l)},p:Ee,d(t){t&&d(e)}}}function We(n){let e,t,l=n[7].marketDayIndex!==void 0&&ge(n);return{c(){e=$("Market Day "),l&&l.c(),t=G()},l(r){e=g(r,"Market Day "),l&&l.l(r),t=G()},m(r,f){b(r,e,f),l&&l.m(r,f),b(r,t,f)},p(r,f){r[7].marketDayIndex!==void 0?l?l.p(r,f):(l=ge(r),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(r){r&&(d(e),d(t)),l&&l.d(r)}}}function ge(n){let e=n[7].marketDayIndex+1+"",t;return{c(){t=$(e)},l(l){t=g(l,e)},m(l,r){b(l,t,r)},p(l,r){r&2&&e!==(e=l[7].marketDayIndex+1+"")&&A(t,e)},d(l){l&&d(t)}}}function be(n){let e;return{c(){e=$("🏆️")},l(t){e=g(t,"🏆️")},m(t,l){b(t,e,l)},d(t){t&&d(e)}}}function ye(n,e){let t,l,r,f=pe(e[10].score)+"",a,i,o,u;l=new Ue({props:{name:e[10].name}});let _=e[9]===0&&be();return{key:n,first:null,c(){t=L("li"),Q(l.$$.fragment),r=$(`:
          `),a=$(f),i=j(),_&&_.c(),o=j(),this.h()},l(s){t=V(s,"LI",{});var c=C(t);J(l.$$.fragment,c),r=g(c,`:
          `),a=g(c,f),i=M(c),_&&_.l(c),o=M(c),c.forEach(d),this.h()},h(){this.first=t},m(s,c){b(s,t,c),K(l,t,null),h(t,r),h(t,a),h(t,i),_&&_.m(t,null),h(t,o),u=!0},p(s,c){e=s;const k={};c&2&&(k.name=e[10].name),l.$set(k),(!u||c&2)&&f!==(f=pe(e[10].score)+"")&&A(a,f),e[9]===0?_||(_=be(),_.c(),_.m(t,o)):_&&(_.d(1),_=null)},i(s){u||(z(l.$$.fragment,s),u=!0)},o(s){B(l.$$.fragment,s),u=!1},d(s){s&&d(t),W(l),_&&_.d()}}}function De(n){let e,t,l,r,f,a,i,o,u,_=n[7].time.toLocaleString()+"",s,c,k,y,D=n[7].rankings.length+"",w,S,I,q,F=Math.min(n[7].rankings.length,10)+"",m,E,T,P=[],ie=new Map,Z,R;function se(v,p){return v[7].type==="scrimmage"?We:Ke}let X=se(n),N=X(n),O=Y(n[7].rankings.slice(0,10));const oe=v=>v[10].address;for(let v=0;v<O.length;v+=1){let p=ve(n,O,v),H=oe(p);ie.set(H,P[v]=ye(H,p))}return{c(){e=L("div"),t=L("h3"),N.c(),l=j(),r=L("a"),f=$(">> View tournament"),i=j(),o=L("div"),u=$("Time: "),s=$(_),c=j(),k=L("div"),y=$("Players: "),w=$(D),S=j(),I=L("h4"),q=$("Top "),m=$(F),E=j(),T=L("ol");for(let v=0;v<P.length;v+=1)P[v].c();Z=j(),this.h()},l(v){e=V(v,"DIV",{});var p=C(e);t=V(p,"H3",{class:!0});var H=C(t);N.l(H),H.forEach(d),l=M(p),r=V(p,"A",{href:!0,class:!0});var fe=C(r);f=g(fe,">> View tournament"),fe.forEach(d),i=M(p),o=V(p,"DIV",{});var x=C(o);u=g(x,"Time: "),s=g(x,_),x.forEach(d),c=M(p),k=V(p,"DIV",{});var ee=C(k);y=g(ee,"Players: "),w=g(ee,D),ee.forEach(d),S=M(p),I=V(p,"H4",{});var te=C(I);q=g(te,"Top "),m=g(te,F),te.forEach(d),E=M(p),T=V(p,"OL",{});var ue=C(T);for(let le=0;le<P.length;le+=1)P[le].l(ue);ue.forEach(d),Z=M(p),p.forEach(d),this.h()},h(){U(t,"class","svelte-j2bsx1"),U(r,"href",a=`${_e}/tournament?season=${n[0]+1}&id=${n[7].id}${n[7].marketDayIndex!==void 0?`&idx=${n[7].marketDayIndex+1}`:""}`),U(r,"class","svelte-j2bsx1")},m(v,p){b(v,e,p),h(e,t),N.m(t,null),h(e,l),h(e,r),h(r,f),h(e,i),h(e,o),h(o,u),h(o,s),h(e,c),h(e,k),h(k,y),h(k,w),h(e,S),h(e,I),h(I,q),h(I,m),h(e,E),h(e,T);for(let H=0;H<P.length;H+=1)P[H]&&P[H].m(T,null);h(e,Z),R=!0},p(v,p){X===(X=se(v))&&N?N.p(v,p):(N.d(1),N=X(v),N&&(N.c(),N.m(t,null))),(!R||p&3&&a!==(a=`${_e}/tournament?season=${v[0]+1}&id=${v[7].id}${v[7].marketDayIndex!==void 0?`&idx=${v[7].marketDayIndex+1}`:""}`))&&U(r,"href",a),(!R||p&2)&&_!==(_=v[7].time.toLocaleString()+"")&&A(s,_),(!R||p&2)&&D!==(D=v[7].rankings.length+"")&&A(w,D),(!R||p&2)&&F!==(F=Math.min(v[7].rankings.length,10)+"")&&A(m,F),p&2&&(O=Y(v[7].rankings.slice(0,10)),ne(),P=Ve(P,p,oe,1,v,O,ie,T,Ce,ye,null,ve),ae())},i(v){if(!R){for(let p=0;p<O.length;p+=1)z(P[p]);R=!0}},o(v){for(let p=0;p<P.length;p+=1)B(P[p]);R=!1},d(v){v&&d(e),N.d();for(let p=0;p<P.length;p+=1)P[p].d()}}}function Xe(n){let e,t,l,r;const f=[Ge,qe,Re],a=[];function i(o,u){return o[2].length===0||o[1]instanceof Promise?0:o[1]instanceof Error?1:o[1]&&typeof o[0]=="number"?2:-1}return~(e=i(n))&&(t=a[e]=f[e](n)),{c(){t&&t.c(),l=G()},l(o){t&&t.l(o),l=G()},m(o,u){~e&&a[e].m(o,u),b(o,l,u),r=!0},p(o,u){let _=e;e=i(o),e===_?~e&&a[e].p(o,u):(t&&(ne(),B(a[_],1,1,()=>{a[_]=null}),ae()),~e?(t=a[e],t?t.p(o,u):(t=a[e]=f[e](o),t.c()),z(t,1),t.m(l.parentNode,l)):t=null)},i(o){r||(z(t),r=!0)},o(o){B(t),r=!1},d(o){o&&d(l),~e&&a[e].d(o)}}}function Ye(n){let e,t;return e=new Ae({props:{title:"Season Details",$$slots:{default:[Xe]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){J(e.$$.fragment,l)},m(l,r){K(e,l,r),t=!0},p(l,[r]){const f={};r&4103&&(f.$$scope={dirty:r,ctx:l}),e.$set(f)},i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){B(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Ze(n,e,t){let l,r;ce(n,je,_=>t(4,l=_));const{seasons:f}=Me();ce(n,f,_=>t(2,r=_));let a=null,i;const o=He(_=>t(1,i=_));function u(_){t(0,a=Number(_.get("season")??"1")-1),isNaN(a)&&t(1,i=new re("Invalid season"))}return n.$$.update=()=>{n.$$.dirty&16&&u(l.url.searchParams),n.$$.dirty&1&&a!==null&&o(async()=>{if(a===null)throw new re("Invalid season");const _=await fetch(`${Ne}/results?season=${a}`);if(!_.ok)throw console.error(await _.text()),new Error(_.statusText);const s=await _.json();if(!s)throw new re("Season not found.");const c=s.map(D=>({...D,time:new Date(D.time)})).sort((D,w)=>-ze(D.time,w.time));let y=c.reduce((D,w)=>w.type==="scrimmage"?D+1:D,0);for(const D of c)D.type==="scrimmage"&&(D.marketDayIndex=--y);return c})},[a,i,r,f,l]}class ot extends Te{constructor(e){super(),Le(this,e,Ze,Ye,Se,{})}}export{ot as component};
