import{s as ye,c as Me,e as E,d as A,f as D,i as m,v as I,R as Ot,M as H,k as N,$ as zt,x as fe,u as Ce,g as Re,a as Le,r as Ge,o as de,a0 as Ut,I as Gt,a1 as Ht,G as Pe,a2 as Mt,a3 as Ct,p as Ie,b as R,t as S,j as L,h as V,l as k,m as J,n as ke,B as me,q as Fe}from"../chunks/scheduler.C1FoT2GD.js";import{S as qe,i as Ee,t as C,a as j,c as ne,b as ae,m as re,d as oe,g as ce,e as _e}from"../chunks/index.DFmxPlw4.js";import{e as X,u as Ve,o as Oe,d as Jt}from"../chunks/each.Bmx-BImQ.js";import{d as Se,w as be,b as ge}from"../chunks/paths.DOnYZ1f4.js";import{p as Xt}from"../chunks/stores.ZuLyBo9H.js";import{U as Qt,P as Wt,c as Yt,g as We}from"../chunks/kit.B5hTzwHX.js";import{P as Zt,L as Kt,C as Rt}from"../chunks/page.CWCv2ozC.js";import{P as Ae}from"../chunks/player.rNBuc2kc.js";function ze(s,e){var t=s[0],l=e[0],n=(e[1]-l)/(s[1]-t);return Object.assign(function(a){return l+(a-t)*n},{inverse:function(){return ze(e,s)}})}function xt(s){let e,t,l,n,a;const r=s[15].default,o=Me(r,s,s[14],null);return{c(){e=E("div"),o&&o.c(),this.h()},l(i){e=A(i,"DIV",{class:!0});var f=D(e);o&&o.l(f),f.forEach(m),this.h()},h(){I(e,"class","pancake-chart svelte-1gzh5rp"),Ot(()=>s[17].call(e)),H(e,"clip",s[0])},m(i,f){N(i,e,f),o&&o.m(e,null),s[16](e),t=zt(e,s[17].bind(e)),l=!0,n||(a=[fe(e,"mousemove",s[6]),fe(e,"mouseleave",s[7])],n=!0)},p(i,[f]){o&&o.p&&(!l||f&16384)&&Ce(o,r,i,i[14],l?Le(r,i[14],f,null):Re(i[14]),null),(!l||f&1)&&H(e,"clip",i[0])},i(i){l||(C(o,i),l=!0)},o(i){j(o,i),l=!1},d(i){i&&m(e),o&&o.d(i),s[16](null),t(),n=!1,Ge(a)}}}const Lt={};function Ft(){return Ht(Lt)}function el(s,e,t){let l,n,a,r,{$$slots:o={},$$scope:i}=e,{x1:f=0}=e,{y1:u=0}=e,{x2:d=1}=e,{y2:p=1}=e,{clip:c=!1}=e,y;const g=be(),b=be(),h=be(),_=be(),v=be();de(s,v,w=>t(2,a=w));const q=be();de(s,q,w=>t(3,r=w));const B=be(null),M=w=>{const Q=y.getBoundingClientRect(),te=w.clientX-Q.left,x=w.clientY-Q.top,ie=n(100*te/(Q.right-Q.left)),U=l(100*x/(Q.bottom-Q.top));B.set({x:ie,y:U,left:te,top:x})},z=()=>{B.set(null)},K=Se([g,h],([w,Q])=>ze([w,Q],[0,100])),O=Se([b,_],([w,Q])=>ze([w,Q],[100,0])),ue=Se(K,w=>w.inverse());de(s,ue,w=>t(19,n=w));const le=Se(O,w=>w.inverse());de(s,le,w=>t(18,l=w)),Ut(Lt,{x1:g,y1:b,x2:h,y2:_,x_scale:K,y_scale:O,x_scale_inverse:ue,y_scale_inverse:le,pointer:B,width:v,height:q});function P(w){Gt[w?"unshift":"push"](()=>{y=w,t(1,y)})}function $(){a=this.clientWidth,v.set(a),r=this.clientHeight,q.set(r)}return s.$$set=w=>{"x1"in w&&t(10,f=w.x1),"y1"in w&&t(11,u=w.y1),"x2"in w&&t(12,d=w.x2),"y2"in w&&t(13,p=w.y2),"clip"in w&&t(0,c=w.clip),"$$scope"in w&&t(14,i=w.$$scope)},s.$$.update=()=>{s.$$.dirty&1024&&g.set(f),s.$$.dirty&2048&&b.set(u),s.$$.dirty&4096&&h.set(d),s.$$.dirty&8192&&_.set(p)},[c,y,a,r,v,q,M,z,ue,le,f,u,d,p,i,o,P,$]}class tl extends qe{constructor(e){super(),Ee(this,e,el,xt,ye,{x1:10,y1:11,x2:12,y2:13,clip:0})}}function ll(s){let e,t;const l=s[7].default,n=Me(l,s,s[6],null);return{c(){e=E("div"),n&&n.c(),this.h()},l(a){e=A(a,"DIV",{class:!0,style:!0});var r=D(e);n&&n.l(r),r.forEach(m),this.h()},h(){I(e,"class","pancake-point svelte-11ba04d"),Pe(e,"left",s[2](s[0])+"%"),Pe(e,"top",s[3](s[1])+"%")},m(a,r){N(a,e,r),n&&n.m(e,null),t=!0},p(a,[r]){n&&n.p&&(!t||r&64)&&Ce(n,l,a,a[6],t?Le(l,a[6],r,null):Re(a[6]),null),(!t||r&5)&&Pe(e,"left",a[2](a[0])+"%"),(!t||r&10)&&Pe(e,"top",a[3](a[1])+"%")},i(a){t||(C(n,a),t=!0)},o(a){j(n,a),t=!1},d(a){a&&m(e),n&&n.d(a)}}}function sl(s,e,t){let l,n,{$$slots:a={},$$scope:r}=e;const{x_scale:o,y_scale:i}=Ft();de(s,o,d=>t(2,l=d)),de(s,i,d=>t(3,n=d));let{x:f}=e,{y:u}=e;return s.$$set=d=>{"x"in d&&t(0,f=d.x),"y"in d&&t(1,u=d.y),"$$scope"in d&&t(6,r=d.$$scope)},[f,u,l,n,o,i,r,a]}class nl extends qe{constructor(e){super(),Ee(this,e,sl,ll,ye,{x:0,y:1})}}const al=s=>s.x,rl=s=>s.y;function ol(s){let e,t;const l=s[2].default,n=Me(l,s,s[1],null);return{c(){e=Mt("svg"),n&&n.c(),this.h()},l(a){e=Ct(a,"svg",{viewBox:!0,preserveAspectRatio:!0,class:!0});var r=D(e);n&&n.l(r),r.forEach(m),this.h()},h(){I(e,"viewBox","0 0 100 100"),I(e,"preserveAspectRatio","none"),I(e,"class","svelte-4s4ihd"),H(e,"clip",s[0])},m(a,r){N(a,e,r),n&&n.m(e,null),t=!0},p(a,[r]){n&&n.p&&(!t||r&2)&&Ce(n,l,a,a[1],t?Le(l,a[1],r,null):Re(a[1]),null),(!t||r&1)&&H(e,"clip",a[0])},i(a){t||(C(n,a),t=!0)},o(a){j(n,a),t=!1},d(a){a&&m(e),n&&n.d(a)}}}function il(s,e,t){let{$$slots:l={},$$scope:n}=e,{clip:a=!1}=e;return s.$$set=r=>{"clip"in r&&t(0,a=r.clip),"$$scope"in r&&t(1,n=r.$$scope)},[a,n,l]}class ul extends qe{constructor(e){super(),Ee(this,e,il,ol,ye,{clip:0})}}const fl=s=>({d:s&1}),Ye=s=>({d:s[0]});function cl(s){let e;const t=s[9].default,l=Me(t,s,s[8],Ye);return{c(){l&&l.c()},l(n){l&&l.l(n)},m(n,a){l&&l.m(n,a),e=!0},p(n,[a]){l&&l.p&&(!e||a&257)&&Ce(l,t,n,n[8],e?Le(t,n[8],a,fl):Re(n[8]),Ye)},i(n){e||(C(l,n),e=!0)},o(n){j(l,n),e=!1},d(n){l&&l.d(n)}}}function _l(s,e,t){let l,n,a,{$$slots:r={},$$scope:o}=e;const{x_scale:i,y_scale:f}=Ft();de(s,i,c=>t(7,a=c)),de(s,f,c=>t(6,n=c));let{data:u}=e,{x:d=al}=e,{y:p=rl}=e;return s.$$set=c=>{"data"in c&&t(3,u=c.data),"x"in c&&t(4,d=c.x),"y"in c&&t(5,p=c.y),"$$scope"in c&&t(8,o=c.$$scope)},s.$$.update=()=>{s.$$.dirty&248&&t(0,l="M"+u.map((c,y)=>`${a(d(c,y))},${n(p(c,y))}`).join("L"))},[l,i,f,u,d,p,n,a,o,r]}class dl extends qe{constructor(e){super(),Ee(this,e,_l,cl,ye,{data:3,x:4,y:5})}}function Ze(s,e,t){const l=s.slice();return l[25]=e[t],l[27]=t,l}function Ke(s,e,t){const l=s.slice();return l[28]=e[t].playerIdx,l[29]=e[t].swaps,l[31]=t,l}function xe(s,e,t){const l=s.slice();return l[32]=e[t],l}function et(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function tt(s,e,t){const l=s.slice();return l[28]=e[t],l}function lt(s,e,t){const l=s.slice();return l[40]=e[t],l[37]=t,l}function st(s,e,t){const l=s.slice();return l[42]=e[t],l[44]=t,l}function nt(s,e,t){const l=s.slice();return l[45]=e[t],l}function at(s,e,t){const l=s.slice();return l[45]=e[t],l[50]=t,l}function rt(s,e,t){const l=s.slice();return l[45]=e[t],l[50]=t,l}function ot(s,e,t){const l=s.slice();l[25]=e[t],l[27]=t;const n=l[25].balances[l[45].idx];l[52]=n;const a=l[52].slice(1).reduce(function(...o){return s[15](l[52],...o)},0)+1;return l[53]=a,l}function it(s,e,t){const l=s.slice();return l[45]=e[t],l[50]=t,l}function ut(s){const e=s.slice(),t=e[0].players.slice().sort((l,n)=>n.score-l.score);return e[48]=t,e}function hl(s){let e,t,l,n=s[0].time.toLocaleString()+"",a,r,o,i,f,u=[],d=new Map,p;e=new Kt({props:{$$slots:{default:[gl]},$$scope:{ctx:s}}});let c=kl(ut(s)),y=s[0].undeployedPlayers.length&&mt(s),g=X(s[0].rounds);const b=h=>h[27];for(let h=0;h<g.length;h+=1){let _=Ze(s,g,h),v=b(_);d.set(v,u[h]=Nt(v,_))}return{c(){ne(e.$$.fragment),t=R(),l=E("section"),a=S(n),r=R(),o=E("section"),c&&c.c(),i=R(),y&&y.c(),f=R();for(let h=0;h<u.length;h+=1)u[h].c();this.h()},l(h){ae(e.$$.fragment,h),t=L(h),l=A(h,"SECTION",{class:!0});var _=D(l);a=V(_,n),_.forEach(m),r=L(h),o=A(h,"SECTION",{class:!0});var v=D(o);c&&c.l(v),i=L(v),y&&y.l(v),f=L(v);for(let q=0;q<u.length;q+=1)u[q].l(v);v.forEach(m),this.h()},h(){I(l,"class","date svelte-10qxq0u"),I(o,"class","svelte-10qxq0u")},m(h,_){re(e,h,_),N(h,t,_),N(h,l,_),k(l,a),N(h,r,_),N(h,o,_),c&&c.m(o,null),k(o,i),y&&y.m(o,null),k(o,f);for(let v=0;v<u.length;v+=1)u[v]&&u[v].m(o,null);p=!0},p(h,_){const v={};_[0]&3|_[1]&67108864&&(v.$$scope={dirty:_,ctx:h}),e.$set(v),(!p||_[0]&1)&&n!==(n=h[0].time.toLocaleString()+"")&&J(a,n),c.p(ut(h),_),h[0].undeployedPlayers.length?y?(y.p(h,_),_[0]&1&&C(y,1)):(y=mt(h),y.c(),C(y,1),y.m(o,f)):y&&(ce(),j(y,1,1,()=>{y=null}),_e()),_[0]&21&&(g=X(h[0].rounds),ce(),u=Ve(u,_,b,1,h,g,d,o,Oe,Nt,null,Ze),_e())},i(h){if(!p){C(e.$$.fragment,h),C(c),C(y);for(let _=0;_<g.length;_+=1)C(u[_]);p=!0}},o(h){j(e.$$.fragment,h),j(c),j(y);for(let _=0;_<u.length;_+=1)j(u[_]);p=!1},d(h){h&&(m(t),m(l),m(r),m(o)),oe(e,h),c&&c.d(),y&&y.d();for(let _=0;_<u.length;_+=1)u[_].d()}}}function ml(s){let e,t,l,n=We(s[0])+"",a,r;return e=new Rt({props:{failed:!0}}),{c(){ne(e.$$.fragment),t=R(),l=E("div"),a=S(n),this.h()},l(o){ae(e.$$.fragment,o),t=L(o),l=A(o,"DIV",{class:!0});var i=D(l);a=V(i,n),i.forEach(m),this.h()},h(){I(l,"class","error")},m(o,i){re(e,o,i),N(o,t,i),N(o,l,i),k(l,a),r=!0},p(o,i){(!r||i[0]&1)&&n!==(n=We(o[0])+"")&&J(a,n)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){j(e.$$.fragment,o),r=!1},d(o){o&&(m(t),m(l)),oe(e,o)}}}function pl(s){let e,t,l;return t=new Rt({}),{c(){e=E("div"),ne(t.$$.fragment),this.h()},l(n){e=A(n,"DIV",{class:!0});var a=D(e);ae(t.$$.fragment,a),a.forEach(m),this.h()},h(){I(e,"class","loading")},m(n,a){N(n,e,a),re(t,e,null),l=!0},p:ke,i(n){l||(C(t.$$.fragment,n),l=!0)},o(n){j(t.$$.fragment,n),l=!1},d(n){n&&m(e),oe(t)}}}function ft(s){let e=s[1]+1+"",t;return{c(){t=S(e)},l(l){t=V(l,e)},m(l,n){N(l,t,n)},p(l,n){n[0]&2&&e!==(e=l[1]+1+"")&&J(t,e)},d(l){l&&m(t)}}}function vl(s){let e;return{c(){e=S("Grand Faire")},l(t){e=V(t,"Grand Faire")},m(t,l){N(t,e,l)},d(t){t&&m(e)}}}function bl(s){let e;return{c(){e=S("Market Day")},l(t){e=V(t,"Market Day")},m(t,l){N(t,e,l)},d(t){t&&m(e)}}}function gl(s){let e,t,l,n,a=s[0].time.toLocaleString()+"",r,o,i,f,u,d=s[0].season+1+"",p,c,y,g,b,h,_,v,q,B,M=s[0].bracket+1+"",z,K,O=s[1]!==void 0&&ft(s);function ue($,w){return $[0].type=="scrimmage"?bl:vl}let le=ue(s),P=le(s);return{c(){e=E("h1"),t=S("Match "),O&&O.c(),l=R(),n=E("div"),r=S(a),o=R(),i=E("div"),f=E("a"),u=S("Season "),p=S(d),y=R(),g=E("div"),b=E("a"),P.c(),_=R(),v=E("div"),q=E("a"),B=S("Bracket "),z=S(M),this.h()},l($){e=A($,"H1",{class:!0});var w=D(e);t=V(w,"Match "),O&&O.l(w),w.forEach(m),l=L($),n=A($,"DIV",{class:!0});var Q=D(n);r=V(Q,a),Q.forEach(m),o=L($),i=A($,"DIV",{});var te=D(i);f=A(te,"A",{href:!0,class:!0});var x=D(f);u=V(x,"Season "),p=V(x,d),x.forEach(m),te.forEach(m),y=L($),g=A($,"DIV",{});var ie=D(g);b=A(ie,"A",{href:!0,class:!0});var U=D(b);P.l(U),U.forEach(m),ie.forEach(m),_=L($),v=A($,"DIV",{});var se=D(v);q=A(se,"A",{href:!0,class:!0});var G=D(q);B=V(G,"Bracket "),z=V(G,M),G.forEach(m),se.forEach(m),this.h()},h(){I(e,"class","svelte-10qxq0u"),I(n,"class","date svelte-10qxq0u"),I(f,"href",c=`${ge}/season?season=${s[0].season+1}`),I(f,"class","svelte-10qxq0u"),I(b,"href",h=`${ge}/tournament?id=${s[0].tournamentId}&season=${s[0].season+1}`),I(b,"class","svelte-10qxq0u"),I(q,"href",K=`${ge}/bracket?tournament=${s[0].tournamentId}&season=${s[0].season+1}&bracket=${s[0].bracket+1}`),I(q,"class","svelte-10qxq0u")},m($,w){N($,e,w),k(e,t),O&&O.m(e,null),N($,l,w),N($,n,w),k(n,r),N($,o,w),N($,i,w),k(i,f),k(f,u),k(f,p),N($,y,w),N($,g,w),k(g,b),P.m(b,null),N($,_,w),N($,v,w),k(v,q),k(q,B),k(q,z)},p($,w){$[1]!==void 0?O?O.p($,w):(O=ft($),O.c(),O.m(e,null)):O&&(O.d(1),O=null),w[0]&1&&a!==(a=$[0].time.toLocaleString()+"")&&J(r,a),w[0]&1&&d!==(d=$[0].season+1+"")&&J(p,d),w[0]&1&&c!==(c=`${ge}/season?season=${$[0].season+1}`)&&I(f,"href",c),le!==(le=ue($))&&(P.d(1),P=le($),P&&(P.c(),P.m(b,null))),w[0]&1&&h!==(h=`${ge}/tournament?id=${$[0].tournamentId}&season=${$[0].season+1}`)&&I(b,"href",h),w[0]&1&&M!==(M=$[0].bracket+1+"")&&J(z,M),w[0]&1&&K!==(K=`${ge}/bracket?tournament=${$[0].tournamentId}&season=${$[0].season+1}&bracket=${$[0].bracket+1}`)&&I(q,"href",K)},d($){$&&(m(e),m(l),m(n),m(o),m(i),m(y),m(g),m(_),m(v)),O&&O.d(),P.d()}}}function kl(s){let e,t,l,n,a,r=s[0].rounds.length+"",o,i,f;return t=new tl({props:{x1:-1,x2:s[0].rounds.length,y1:-1,y2:Math.max(...s[0].rounds.map(Bt).flat(2))+1,$$slots:{default:[Dl]},$$scope:{ctx:s}}}),{c(){e=E("div"),ne(t.$$.fragment),l=R(),n=E("div"),a=S("("),o=S(r),i=S("/32 rounds played)"),this.h()},l(u){e=A(u,"DIV",{class:!0});var d=D(e);ae(t.$$.fragment,d),l=L(d),n=A(d,"DIV",{class:!0});var p=D(n);a=V(p,"("),o=V(p,r),i=V(p,"/32 rounds played)"),p.forEach(m),d.forEach(m),this.h()},h(){I(n,"class","rounds-count svelte-10qxq0u"),I(e,"class","chart svelte-10qxq0u"),H(e,"has-focus",!!s[3])},m(u,d){N(u,e,d),re(t,e,null),k(e,l),k(e,n),k(n,a),k(n,o),k(n,i),f=!0},p(u,d){const p={};d[0]&1&&(p.x2=u[0].rounds.length),d[0]&1&&(p.y2=Math.max(...u[0].rounds.map(Bt).flat(2))+1),d[0]&9|d[1]&67108864&&(p.$$scope={dirty:d,ctx:u}),t.$set(p),(!f||d[0]&1)&&r!==(r=u[0].rounds.length+"")&&J(o,r),(!f||d[0]&8)&&H(e,"has-focus",!!u[3])},i(u){f||(C(t.$$.fragment,u),f=!0)},o(u){j(t.$$.fragment,u),f=!1},d(u){u&&m(e),oe(t)}}}function Il(s){let e,t;return{c(){e=Mt("path"),this.h()},l(l){e=Ct(l,"path",{class:!0,d:!0}),D(e).forEach(m),this.h()},h(){var l;I(e,"class","line svelte-10qxq0u"),I(e,"d",t=s[56]),H(e,"focused",((l=s[3])==null?void 0:l.address)===s[45].address)},m(l,n){N(l,e,n)},p(l,n){var a;n[1]&33554432&&t!==(t=l[56])&&I(e,"d",t),n[0]&9&&H(e,"focused",((a=l[3])==null?void 0:a.address)===l[45].address)},d(l){l&&m(e)}}}function yl(s){let e,t;function l(...n){return s[10](s[45],...n)}return e=new dl({props:{data:s[0].rounds.map(l),$$slots:{default:[Il,({d:n})=>({56:n}),({d:n})=>[0,n?33554432:0]]},$$scope:{ctx:s}}}),{c(){ne(e.$$.fragment)},l(n){ae(e.$$.fragment,n)},m(n,a){re(e,n,a),t=!0},p(n,a){s=n;const r={};a[0]&1&&(r.data=s[0].rounds.map(l)),a[0]&9|a[1]&100663296&&(r.$$scope={dirty:a,ctx:s}),e.$set(r)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){j(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function ct(s,e){let t,l,n,a;return l=new ul({props:{$$slots:{default:[yl]},$$scope:{ctx:e}}}),{key:s,first:null,c(){t=E("div"),ne(l.$$.fragment),this.h()},l(r){t=A(r,"DIV",{class:!0,"data-rank":!0});var o=D(t);ae(l.$$.fragment,o),o.forEach(m),this.h()},h(){I(t,"class","player-scores svelte-10qxq0u"),I(t,"data-rank",n=e[50]),this.first=t},m(r,o){N(r,t,o),re(l,t,null),a=!0},p(r,o){e=r;const i={};o[0]&9|o[1]&67108864&&(i.$$scope={dirty:o,ctx:e}),l.$set(i),(!a||o[0]&1&&n!==(n=e[50]))&&I(t,"data-rank",n)},i(r){a||(C(l.$$.fragment,r),a=!0)},o(r){j(l.$$.fragment,r),a=!1},d(r){r&&m(t),oe(l)}}}function ql(s){let e=s[4](s[53])+"",t;return{c(){t=S(e)},l(l){t=V(l,e)},m(l,n){N(l,t,n)},p(l,n){n[0]&1&&e!==(e=l[4](l[53])+"")&&J(t,e)},d(l){l&&m(t)}}}function El(s){let e=s[4](0)+"",t;return{c(){t=S(e)},l(l){t=V(l,e)},m(l,n){N(l,t,n)},p:ke,d(l){l&&m(t)}}}function Al(s){let e=Z(s[52][s[53]])+"",t;return{c(){t=S(e)},l(l){t=V(l,e)},m(l,n){N(l,t,n)},p(l,n){n[0]&1&&e!==(e=Z(l[52][l[53]])+"")&&J(t,e)},d(l){l&&m(t)}}}function $l(s){let e=Z(s[52][0])+"",t;return{c(){t=S(e)},l(l){t=V(l,e)},m(l,n){N(l,t,n)},p(l,n){n[0]&1&&e!==(e=Z(l[52][0])+"")&&J(t,e)},d(l){l&&m(t)}}}function wl(s){let e,t,l,n,a,r;function o(g,b){return g[52][g[53]]<=0?El:ql}let i=o(s),f=i(s);function u(g,b){return g[52][g[53]]<=0?$l:Al}let d=u(s),p=d(s);function c(){return s[11](s[45])}function y(){return s[13](s[45])}return{c(){e=E("a"),t=E("div"),f.c(),l=R(),n=E("div"),p.c(),this.h()},l(g){e=A(g,"A",{class:!0,href:!0});var b=D(e);t=A(b,"DIV",{class:!0});var h=D(t);f.l(h),h.forEach(m),l=L(b),n=A(b,"DIV",{class:!0});var _=D(n);p.l(_),_.forEach(m),b.forEach(m),this.h()},h(){var g,b;I(t,"class","emoji svelte-10qxq0u"),I(n,"class","label svelte-10qxq0u"),I(e,"class","item svelte-10qxq0u"),I(e,"href",`#round-${s[27]+1}`),H(e,"final",s[27]===s[0].rounds.length-1),H(e,"focused",((g=s[3])==null?void 0:g.address)===s[45].address),H(e,"is-builder",((b=s[25].block)==null?void 0:b.builderIdx)===s[45].idx)},m(g,b){N(g,e,b),k(e,t),f.m(t,null),k(e,l),k(e,n),p.m(n,null),a||(r=[fe(e,"mouseover",c),fe(e,"mouseout",s[12]),fe(e,"focus",y),fe(e,"blur",s[14])],a=!0)},p(g,b){var h,_;s=g,i===(i=o(s))&&f?f.p(s,b):(f.d(1),f=i(s),f&&(f.c(),f.m(t,null))),d===(d=u(s))&&p?p.p(s,b):(p.d(1),p=d(s),p&&(p.c(),p.m(n,null))),b[0]&1&&H(e,"final",s[27]===s[0].rounds.length-1),b[0]&9&&H(e,"focused",((h=s[3])==null?void 0:h.address)===s[45].address),b[0]&1&&H(e,"is-builder",((_=s[25].block)==null?void 0:_.builderIdx)===s[45].idx)},d(g){g&&m(e),f.d(),p.d(),a=!1,Ge(r)}}}function _t(s){let e,t;return e=new nl({props:{x:s[27],y:s[52][s[53]],$$slots:{default:[wl]},$$scope:{ctx:s}}}),{c(){ne(e.$$.fragment)},l(l){ae(e.$$.fragment,l)},m(l,n){re(e,l,n),t=!0},p(l,n){const a={};n[0]&1&&(a.y=l[52][l[53]]),n[0]&9|n[1]&67108864&&(a.$$scope={dirty:n,ctx:l}),e.$set(a)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){oe(e,l)}}}function dt(s){let e,t,l,n=X(s[0].rounds),a=[];for(let o=0;o<n.length;o+=1)a[o]=_t(ot(s,n,o));const r=o=>j(a[o],1,1,()=>{a[o]=null});return{c(){e=E("div");for(let o=0;o<a.length;o+=1)a[o].c();t=R(),this.h()},l(o){e=A(o,"DIV",{class:!0,"data-rank":!0});var i=D(e);for(let f=0;f<a.length;f+=1)a[f].l(i);t=L(i),i.forEach(m),this.h()},h(){I(e,"class","interactive-points svelte-10qxq0u"),I(e,"data-rank",s[50])},m(o,i){N(o,e,i);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(e,null);k(e,t),l=!0},p(o,i){if(i[0]&25){n=X(o[0].rounds);let f;for(f=0;f<n.length;f+=1){const u=ot(o,n,f);a[f]?(a[f].p(u,i),C(a[f],1)):(a[f]=_t(u),a[f].c(),C(a[f],1),a[f].m(e,t))}for(ce(),f=n.length;f<a.length;f+=1)r(f);_e()}},i(o){if(!l){for(let i=0;i<n.length;i+=1)C(a[i]);l=!0}},o(o){a=a.filter(Boolean);for(let i=0;i<a.length;i+=1)j(a[i]);l=!1},d(o){o&&m(e),me(a,o)}}}function ht(s,e){let t,l,n="🏆️",a,r,o,i,f=e[4](e[45].scoreAssetIdx)+"",u,d,p=Z(e[45].score)+"",c,y,g,b,h,_;r=new Ae({props:{name:e[45].name}});function v(){return e[16](e[45])}function q(){return e[18](e[45])}return{key:s,first:null,c(){t=E("div"),l=E("span"),l.textContent=n,a=R(),ne(r.$$.fragment),o=S(`:
              `),i=E("span"),u=S(f),d=R(),c=S(p),y=R(),this.h()},l(B){t=A(B,"DIV",{class:!0,"data-rank":!0});var M=D(t);l=A(M,"SPAN",{class:!0,"data-svelte-h":!0}),Fe(l)!=="svelte-1kjg1ih"&&(l.textContent=n),a=L(M),ae(r.$$.fragment,M),o=V(M,`:
              `),i=A(M,"SPAN",{class:!0});var z=D(i);u=V(z,f),d=L(z),c=V(z,p),z.forEach(m),y=L(M),M.forEach(m),this.h()},h(){I(l,"class","trophy svelte-10qxq0u"),H(l,"show",e[45].idx===e[0].winnerIdx),I(i,"class","score"),I(t,"class","player-label svelte-10qxq0u"),I(t,"data-rank",g=e[50]),this.first=t},m(B,M){N(B,t,M),k(t,l),k(t,a),re(r,t,null),k(t,o),k(t,i),k(i,u),k(i,d),k(i,c),k(t,y),b=!0,h||(_=[fe(t,"mouseover",v),fe(t,"mouseout",e[17]),fe(t,"focus",q),fe(t,"blur",e[19])],h=!0)},p(B,M){e=B,(!b||M[0]&1)&&H(l,"show",e[45].idx===e[0].winnerIdx);const z={};M[0]&1&&(z.name=e[45].name),r.$set(z),(!b||M[0]&1)&&f!==(f=e[4](e[45].scoreAssetIdx)+"")&&J(u,f),(!b||M[0]&1)&&p!==(p=Z(e[45].score)+"")&&J(c,p),(!b||M[0]&1&&g!==(g=e[50]))&&I(t,"data-rank",g)},i(B){b||(C(r.$$.fragment,B),b=!0)},o(B){j(r.$$.fragment,B),b=!1},d(B){B&&m(t),oe(r),h=!1,Ge(_)}}}function Dl(s){let e,t=[],l=new Map,n,a,r,o=[],i=new Map,f,u=X(s[48]);const d=h=>h[45].idx;for(let h=0;h<u.length;h+=1){let _=it(s,u,h),v=d(_);l.set(v,t[h]=ct(v,_))}let p=X(s[48]),c=[];for(let h=0;h<p.length;h+=1)c[h]=dt(rt(s,p,h));const y=h=>j(c[h],1,1,()=>{c[h]=null});let g=X(s[48]);const b=h=>h[45].idx;for(let h=0;h<g.length;h+=1){let _=at(s,g,h),v=b(_);i.set(v,o[h]=ht(v,_))}return{c(){e=E("div");for(let h=0;h<t.length;h+=1)t[h].c();n=R();for(let h=0;h<c.length;h+=1)c[h].c();a=R(),r=E("div");for(let h=0;h<o.length;h+=1)o[h].c();this.h()},l(h){e=A(h,"DIV",{class:!0});var _=D(e);for(let q=0;q<t.length;q+=1)t[q].l(_);n=L(_);for(let q=0;q<c.length;q+=1)c[q].l(_);_.forEach(m),a=L(h),r=A(h,"DIV",{class:!0});var v=D(r);for(let q=0;q<o.length;q+=1)o[q].l(v);v.forEach(m),this.h()},h(){I(e,"class","plots"),I(r,"class","legend")},m(h,_){N(h,e,_);for(let v=0;v<t.length;v+=1)t[v]&&t[v].m(e,null);k(e,n);for(let v=0;v<c.length;v+=1)c[v]&&c[v].m(e,null);N(h,a,_),N(h,r,_);for(let v=0;v<o.length;v+=1)o[v]&&o[v].m(r,null);f=!0},p(h,_){if(_[0]&9|_[1]&33554432&&(u=X(h[48]),ce(),t=Ve(t,_,d,1,h,u,l,e,Oe,ct,n,it),_e()),_[0]&25){p=X(h[48]);let v;for(v=0;v<p.length;v+=1){const q=rt(h,p,v);c[v]?(c[v].p(q,_),C(c[v],1)):(c[v]=dt(q),c[v].c(),C(c[v],1),c[v].m(e,null))}for(ce(),v=p.length;v<c.length;v+=1)y(v);_e()}_[0]&25&&(g=X(h[48]),ce(),o=Ve(o,_,b,1,h,g,i,r,Oe,ht,null,at),_e())},i(h){if(!f){for(let _=0;_<u.length;_+=1)C(t[_]);for(let _=0;_<p.length;_+=1)C(c[_]);for(let _=0;_<g.length;_+=1)C(o[_]);f=!0}},o(h){for(let _=0;_<t.length;_+=1)j(t[_]);c=c.filter(Boolean);for(let _=0;_<c.length;_+=1)j(c[_]);for(let _=0;_<o.length;_+=1)j(o[_]);f=!1},d(h){h&&(m(e),m(a),m(r));for(let _=0;_<t.length;_+=1)t[_].d();me(c,h);for(let _=0;_<o.length;_+=1)o[_].d()}}}function mt(s){let e,t,l=X(s[0].undeployedPlayers),n=[];for(let r=0;r<l.length;r+=1)n[r]=pt(nt(s,l,r));const a=r=>j(n[r],1,1,()=>{n[r]=null});return{c(){e=E("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=A(r,"DIV",{class:!0});var o=D(e);for(let i=0;i<n.length;i+=1)n[i].l(o);o.forEach(m),this.h()},h(){I(e,"class","deployment-failures svelte-10qxq0u")},m(r,o){N(r,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);t=!0},p(r,o){if(o[0]&1){l=X(r[0].undeployedPlayers);let i;for(i=0;i<l.length;i+=1){const f=nt(r,l,i);n[i]?(n[i].p(f,o),C(n[i],1)):(n[i]=pt(f),n[i].c(),C(n[i],1),n[i].m(e,null))}for(ce(),i=l.length;i<n.length;i+=1)a(i);_e()}},i(r){if(!t){for(let o=0;o<l.length;o+=1)C(n[o]);t=!0}},o(r){n=n.filter(Boolean);for(let o=0;o<n.length;o+=1)j(n[o]);t=!1},d(r){r&&m(e),me(n,r)}}}function pt(s){let e,t,l,n;return t=new Ae({props:{name:s[45]}}),{c(){e=E("div"),ne(t.$$.fragment),l=S(` failed to deploy.
      `),this.h()},l(a){e=A(a,"DIV",{class:!0});var r=D(e);ae(t.$$.fragment,r),l=V(r,` failed to deploy.
      `),r.forEach(m),this.h()},h(){I(e,"class","failure svelte-10qxq0u")},m(a,r){N(a,e,r),re(t,e,null),k(e,l),n=!0},p(a,r){const o={};r[0]&1&&(o.name=a[45]),t.$set(o)},i(a){n||(C(t.$$.fragment,a),n=!0)},o(a){j(t.$$.fragment,a),n=!1},d(a){a&&m(e),oe(t)}}}function vt(s){let e,t,l="🛒 Market",n,a,r=X(s[25].market),o=[];for(let i=0;i<r.length;i+=1)o[i]=bt(st(s,r,i));return{c(){e=E("div"),t=E("h3"),t.textContent=l,n=R(),a=E("div");for(let i=0;i<o.length;i+=1)o[i].c();this.h()},l(i){e=A(i,"DIV",{class:!0});var f=D(e);t=A(f,"H3",{class:!0,"data-svelte-h":!0}),Fe(t)!=="svelte-7c3fbx"&&(t.textContent=l),n=L(f),a=A(f,"DIV",{class:!0});var u=D(a);for(let d=0;d<o.length;d+=1)o[d].l(u);u.forEach(m),f.forEach(m),this.h()},h(){I(t,"class","svelte-10qxq0u"),I(a,"class","balances svelte-10qxq0u"),I(e,"class","market svelte-10qxq0u")},m(i,f){N(i,e,f),k(e,t),k(e,n),k(e,a);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(a,null)},p(i,f){if(f[0]&17){r=X(i[25].market);let u;for(u=0;u<r.length;u+=1){const d=st(i,r,u);o[u]?o[u].p(d,f):(o[u]=bt(d),o[u].c(),o[u].m(a,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=r.length}},d(i){i&&m(e),me(o,i)}}}function bt(s){let e,t,l=s[4](s[44])+"",n,a,r,o=Z(s[42])+"",i,f;return{c(){e=E("div"),t=E("span"),n=S(l),a=R(),r=E("span"),i=S(o),f=R(),this.h()},l(u){e=A(u,"DIV",{class:!0});var d=D(e);t=A(d,"SPAN",{class:!0});var p=D(t);n=V(p,l),p.forEach(m),a=L(d),r=A(d,"SPAN",{class:!0});var c=D(r);i=V(c,o),c.forEach(m),f=L(d),d.forEach(m),this.h()},h(){I(t,"class","emoji svelte-10qxq0u"),I(r,"class","amount"),I(e,"class","asset svelte-10qxq0u")},m(u,d){N(u,e,d),k(e,t),k(t,n),k(e,a),k(e,r),k(r,i),k(e,f)},p(u,d){d[0]&1&&o!==(o=Z(u[42])+"")&&J(i,o)},d(u){u&&m(e)}}}function gt(s){let e;return{c(){e=S("🏆️")},l(t){e=V(t,"🏆️")},m(t,l){N(t,e,l)},d(t){t&&m(e)}}}function kt(s){let e,t;function l(r,o){if(o[0]&1&&(e=null),r[25].block.bids[r[28]]>0)return Pl;if(e==null&&(e=!!isNaN(r[25].block.bids[r[28]])),e)return Nl}let n=l(s,[-1,-1]),a=n&&n(s);return{c(){a&&a.c(),t=Ie()},l(r){a&&a.l(r),t=Ie()},m(r,o){a&&a.m(r,o),N(r,t,o)},p(r,o){n===(n=l(r,o))&&a?a.p(r,o):(a&&a.d(1),a=n&&n(r),a&&(a.c(),a.m(t.parentNode,t)))},d(r){r&&m(t),a&&a.d(r)}}}function Nl(s){let e,t="FAILED their bid",l;return{c(){e=E("span"),e.textContent=t,l=S(`
            and`),this.h()},l(n){e=A(n,"SPAN",{class:!0,"data-svelte-h":!0}),Fe(e)!=="svelte-1rpx4iy"&&(e.textContent=t),l=V(n,`
            and`),this.h()},h(){I(e,"class","failed-bid")},m(n,a){N(n,e,a),N(n,l,a)},p:ke,d(n){n&&(m(e),m(l))}}}function Pl(s){let e,t,l,n=s[4](0)+"",a,r,o,i=Z(s[25].block.bids[s[28]])+"",f,u;return{c(){e=E("span"),t=S(`bid
              `),l=E("span"),a=S(n),r=R(),o=E("span"),f=S(i),u=S(`
            and`),this.h()},l(d){e=A(d,"SPAN",{class:!0});var p=D(e);t=V(p,`bid
              `),l=A(p,"SPAN",{class:!0});var c=D(l);a=V(c,n),c.forEach(m),r=L(p),o=A(p,"SPAN",{class:!0});var y=D(o);f=V(y,i),y.forEach(m),p.forEach(m),u=V(d,`
            and`),this.h()},h(){I(l,"class","asset"),I(o,"class","quantity"),I(e,"class","bid")},m(d,p){N(d,e,p),k(e,t),k(e,l),k(l,a),k(e,r),k(e,o),k(o,f),N(d,u,p)},p(d,p){p[0]&1&&i!==(i=Z(d[25].block.bids[d[28]])+"")&&J(f,i)},d(d){d&&(m(e),m(u))}}}function It(s){let e,t,l=s[4](s[37])+"",n,a,r,o=Z(Math.max(0,s[40]))+"",i,f,u=s[25].balanceDeltas[s[28]][s[37]]!==0&&yt(s);return{c(){e=E("div"),t=E("span"),n=S(l),a=R(),r=E("span"),i=S(o),f=R(),u&&u.c(),this.h()},l(d){e=A(d,"DIV",{class:!0});var p=D(e);t=A(p,"SPAN",{class:!0});var c=D(t);n=V(c,l),c.forEach(m),a=L(p),r=A(p,"SPAN",{class:!0});var y=D(r);i=V(y,o),y.forEach(m),f=L(p),u&&u.l(p),p.forEach(m),this.h()},h(){I(t,"class","asset"),I(r,"class","quantity"),I(e,"class","balance svelte-10qxq0u")},m(d,p){N(d,e,p),k(e,t),k(t,n),k(e,a),k(e,r),k(r,i),k(e,f),u&&u.m(e,null)},p(d,p){p[0]&1&&o!==(o=Z(Math.max(0,d[40]))+"")&&J(i,o),d[25].balanceDeltas[d[28]][d[37]]!==0?u?u.p(d,p):(u=yt(d),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},d(d){d&&m(e),u&&u.d()}}}function yt(s){let e,t,l=Be(s[25].balanceDeltas[s[28]][s[37]])+"",n,a;return{c(){e=E("span"),t=S("("),n=S(l),a=S(")"),this.h()},l(r){e=A(r,"SPAN",{class:!0});var o=D(e);t=V(o,"("),n=V(o,l),a=V(o,")"),o.forEach(m),this.h()},h(){I(e,"class","delta svelte-10qxq0u"),H(e,"decreased",s[25].balanceDeltas[s[28]][s[37]]<0)},m(r,o){N(r,e,o),k(e,t),k(e,n),k(e,a)},p(r,o){o[0]&1&&l!==(l=Be(r[25].balanceDeltas[r[28]][r[37]])+"")&&J(n,l),o[0]&1&&H(e,"decreased",r[25].balanceDeltas[r[28]][r[37]]<0)},d(r){r&&m(e)}}}function qt(s){let e,t=(s[40]>0||s[25].balanceDeltas[s[28]][s[37]]!==0)&&It(s);return{c(){t&&t.c(),e=Ie()},l(l){t&&t.l(l),e=Ie()},m(l,n){t&&t.m(l,n),N(l,e,n)},p(l,n){l[40]>0||l[25].balanceDeltas[l[28]][l[37]]!==0?t?t.p(l,n):(t=It(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function Et(s){var y;let e,t,l,n,a,r,o,i,f,u=s[27]===s[0].rounds.length-1&&s[28]===s[0].winnerIdx&&gt();n=new Ae({props:{name:s[0].players[s[28]].name}});let d=((y=s[25].block)==null?void 0:y.bids)&&kt(s),p=X(s[25].balances[s[28]]),c=[];for(let g=0;g<p.length;g+=1)c[g]=qt(lt(s,p,g));return{c(){e=E("div"),t=E("span"),u&&u.c(),l=R(),ne(n.$$.fragment),a=R(),d&&d.c(),r=S(`
            holds:`),o=R();for(let g=0;g<c.length;g+=1)c[g].c();i=R(),this.h()},l(g){e=A(g,"DIV",{class:!0});var b=D(e);t=A(b,"SPAN",{class:!0});var h=D(t);u&&u.l(h),l=L(h),ae(n.$$.fragment,h),a=L(h),d&&d.l(h),r=V(h,`
            holds:`),h.forEach(m),o=L(b);for(let _=0;_<c.length;_+=1)c[_].l(b);i=L(b),b.forEach(m),this.h()},h(){var g;I(t,"class","svelte-10qxq0u"),H(t,"builder",s[28]===((g=s[25].block)==null?void 0:g.builderIdx)),I(e,"class","player svelte-10qxq0u")},m(g,b){N(g,e,b),k(e,t),u&&u.m(t,null),k(t,l),re(n,t,null),k(t,a),d&&d.m(t,null),k(t,r),k(e,o);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(e,null);k(e,i),f=!0},p(g,b){var _,v;g[27]===g[0].rounds.length-1&&g[28]===g[0].winnerIdx?u||(u=gt(),u.c(),u.m(t,l)):u&&(u.d(1),u=null);const h={};if(b[0]&1&&(h.name=g[0].players[g[28]].name),n.$set(h),(_=g[25].block)!=null&&_.bids?d?d.p(g,b):(d=kt(g),d.c(),d.m(t,r)):d&&(d.d(1),d=null),(!f||b[0]&1)&&H(t,"builder",g[28]===((v=g[25].block)==null?void 0:v.builderIdx)),b[0]&17){p=X(g[25].balances[g[28]]);let q;for(q=0;q<p.length;q+=1){const B=lt(g,p,q);c[q]?c[q].p(B,b):(c[q]=qt(B),c[q].c(),c[q].m(e,i))}for(;q<c.length;q+=1)c[q].d(1);c.length=p.length}},i(g){f||(C(n.$$.fragment,g),f=!0)},o(g){j(n.$$.fragment,g),f=!1},d(g){g&&m(e),u&&u.d(),oe(n),d&&d.d(),me(c,g)}}}function At(s){let e,t=s[25].block.swaps.length+"",l,n;return{c(){e=S("("),l=S(t),n=S(" swaps)")},l(a){e=V(a,"("),l=V(a,t),n=V(a," swaps)")},m(a,r){N(a,e,r),N(a,l,r),N(a,n,r)},p(a,r){r[0]&1&&t!==(t=a[25].block.swaps.length+"")&&J(l,t)},d(a){a&&(m(e),m(l),m(n))}}}function $t(s,e){let t,l=e[4](e[37])+"",n,a,r,o=Be(e[35])+"",i,f;return{key:s,first:null,c(){t=E("span"),n=S(l),a=R(),r=E("span"),i=S(o),f=S(`
             `),this.h()},l(u){t=A(u,"SPAN",{class:!0});var d=D(t);n=V(d,l),d.forEach(m),a=L(u),r=A(u,"SPAN",{class:!0});var p=D(r);i=V(p,o),p.forEach(m),f=V(u,`
             `),this.h()},h(){I(t,"class","asset"),I(r,"class","quantity"),this.first=t},m(u,d){N(u,t,d),k(t,n),N(u,a,d),N(u,r,d),k(r,i),N(u,f,d)},p(u,d){e=u,d[0]&1&&l!==(l=e[4](e[37])+"")&&J(n,l),d[0]&1&&o!==(o=Be(e[35])+"")&&J(i,o)},d(u){u&&(m(t),m(a),m(r),m(f))}}}function Sl(s){let e,t="Empty Block!";return{c(){e=E("div"),e.textContent=t,this.h()},l(l){e=A(l,"DIV",{class:!0,"data-svelte-h":!0}),Fe(e)!=="svelte-19icdfp"&&(e.textContent=t),this.h()},h(){I(e,"class","empty-block")},m(l,n){N(l,e,n)},p:ke,i:ke,o:ke,d(l){l&&m(e)}}}function Vl(s){let e,t,l,n,a=s[4](0)+"",r,o,i,f=Z(s[25].block.bids[s[25].block.builderIdx])+"",u,d,p,c,y,g=X(Vt(s[25].block.swaps)),b=[];for(let _=0;_<g.length;_+=1)b[_]=Dt(Ke(s,g,_));const h=_=>j(b[_],1,1,()=>{b[_]=null});return c=new Ae({props:{name:s[0].players[s[25].block.builderIdx].name}}),{c(){for(let _=0;_<b.length;_+=1)b[_].c();e=R(),t=E("div"),l=S(`🔥 Burned
            `),n=E("span"),r=S(a),o=R(),i=E("span"),u=S(f),d=S(`
            from
            `),p=E("span"),ne(c.$$.fragment),this.h()},l(_){for(let z=0;z<b.length;z+=1)b[z].l(_);e=L(_),t=A(_,"DIV",{class:!0});var v=D(t);l=V(v,`🔥 Burned
            `),n=A(v,"SPAN",{class:!0});var q=D(n);r=V(q,a),q.forEach(m),o=L(v),i=A(v,"SPAN",{class:!0});var B=D(i);u=V(B,f),B.forEach(m),d=V(v,`
            from
            `),p=A(v,"SPAN",{class:!0});var M=D(p);ae(c.$$.fragment,M),M.forEach(m),v.forEach(m),this.h()},h(){I(n,"class","asset"),I(i,"class","quantity"),I(p,"class","builder svelte-10qxq0u"),I(t,"class","burn step svelte-10qxq0u")},m(_,v){for(let q=0;q<b.length;q+=1)b[q]&&b[q].m(_,v);N(_,e,v),N(_,t,v),k(t,l),k(t,n),k(n,r),k(t,o),k(t,i),k(i,u),k(t,d),k(t,p),re(c,p,null),y=!0},p(_,v){if(v[0]&17){g=X(Vt(_[25].block.swaps));let B;for(B=0;B<g.length;B+=1){const M=Ke(_,g,B);b[B]?(b[B].p(M,v),C(b[B],1)):(b[B]=Dt(M),b[B].c(),C(b[B],1),b[B].m(e.parentNode,e))}for(ce(),B=g.length;B<b.length;B+=1)h(B);_e()}(!y||v[0]&1)&&f!==(f=Z(_[25].block.bids[_[25].block.builderIdx])+"")&&J(u,f);const q={};v[0]&1&&(q.name=_[0].players[_[25].block.builderIdx].name),c.$set(q)},i(_){if(!y){for(let v=0;v<g.length;v+=1)C(b[v]);C(c.$$.fragment,_),y=!0}},o(_){b=b.filter(Boolean);for(let v=0;v<b.length;v+=1)j(b[v]);j(c.$$.fragment,_),y=!1},d(_){_&&(m(e),m(t)),me(b,_),oe(c)}}}function wt(s){let e,t,l=s[4](s[32].fromAssetIdx)+"",n,a,r,o=Z(s[32].fromAmount)+"",i,f,u,d,p=s[4](s[32].toAssetIdx)+"",c,y,g,b=Z(s[32].toAmount)+"",h,_;return{c(){e=E("div"),t=E("span"),n=S(l),a=R(),r=E("span"),i=S(o),u=S(`
              ⇾
              `),d=E("span"),c=S(p),y=R(),g=E("span"),h=S(b),this.h()},l(v){e=A(v,"DIV",{class:!0});var q=D(e);t=A(q,"SPAN",{class:!0});var B=D(t);n=V(B,l),B.forEach(m),a=L(q),r=A(q,"SPAN",{class:!0,title:!0});var M=D(r);i=V(M,o),M.forEach(m),u=V(q,`
              ⇾
              `),d=A(q,"SPAN",{class:!0});var z=D(d);c=V(z,p),z.forEach(m),y=L(q),g=A(q,"SPAN",{class:!0,title:!0});var K=D(g);h=V(K,b),K.forEach(m),q.forEach(m),this.h()},h(){I(t,"class","asset"),I(r,"class","quantity"),I(r,"title",f=s[32].fromAmount.toExponential()),I(d,"class","asset"),I(g,"class","quantity"),I(g,"title",_=s[32].toAmount.toExponential()),I(e,"class","swap svelte-10qxq0u")},m(v,q){N(v,e,q),k(e,t),k(t,n),k(e,a),k(e,r),k(r,i),k(e,u),k(e,d),k(d,c),k(e,y),k(e,g),k(g,h)},p(v,q){q[0]&1&&l!==(l=v[4](v[32].fromAssetIdx)+"")&&J(n,l),q[0]&1&&o!==(o=Z(v[32].fromAmount)+"")&&J(i,o),q[0]&1&&f!==(f=v[32].fromAmount.toExponential())&&I(r,"title",f),q[0]&1&&p!==(p=v[4](v[32].toAssetIdx)+"")&&J(c,p),q[0]&1&&b!==(b=Z(v[32].toAmount)+"")&&J(h,b),q[0]&1&&_!==(_=v[32].toAmount.toExponential())&&I(g,"title",_)},d(v){v&&m(e)}}}function Dt(s){let e,t,l,n,a,r,o;n=new Ae({props:{name:s[0].players[s[28]].name}});let i=X(s[29]),f=[];for(let u=0;u<i.length;u+=1)f[u]=wt(xe(s,i,u));return{c(){e=E("div"),t=E("span"),l=E("span"),ne(n.$$.fragment),a=S(`
              sold:`),r=R();for(let u=0;u<f.length;u+=1)f[u].c();this.h()},l(u){e=A(u,"DIV",{class:!0});var d=D(e);t=A(d,"SPAN",{class:!0});var p=D(t);l=A(p,"SPAN",{class:!0});var c=D(l);ae(n.$$.fragment,c),c.forEach(m),a=V(p,`
              sold:`),p.forEach(m),r=L(d);for(let y=0;y<f.length;y+=1)f[y].l(d);d.forEach(m),this.h()},h(){I(l,"class","svelte-10qxq0u"),H(l,"builder",s[28]===s[25].block.builderIdx),I(t,"class","subject"),I(e,"class","swaps step svelte-10qxq0u"),H(e,"multi",s[29].length>1)},m(u,d){N(u,e,d),k(e,t),k(t,l),re(n,l,null),k(t,a),k(e,r);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(e,null);o=!0},p(u,d){const p={};if(d[0]&1&&(p.name=u[0].players[u[28]].name),n.$set(p),(!o||d[0]&1)&&H(l,"builder",u[28]===u[25].block.builderIdx),d[0]&17){i=X(u[29]);let c;for(c=0;c<i.length;c+=1){const y=xe(u,i,c);f[c]?f[c].p(y,d):(f[c]=wt(y),f[c].c(),f[c].m(e,null))}for(;c<f.length;c+=1)f[c].d(1);f.length=i.length}(!o||d[0]&1)&&H(e,"multi",u[29].length>1)},i(u){o||(C(n.$$.fragment,u),o=!0)},o(u){j(n.$$.fragment,u),o=!1},d(u){u&&m(e),oe(n),me(f,u)}}}function Nt(s,e){let t,l,n,a,r,o,i=e[27]+1+"",f,u,d,p,c,y,g,b,h,_,v,q,B,M,z,K,O=[],ue=new Map,le,P,$,w,Q,te,x,ie,U=e[25].market&&vt(e),se=X(St(e[25].balances,e[20])),G=[];for(let T=0;T<se.length;T+=1)G[T]=Et(tt(e,se,T));const jt=T=>j(G[T],1,1,()=>{G[T]=null});let ee=e[25].block&&At(e);function Tt(){return e[21](e[27])}let $e=X(e[25].resupply[0]);const He=T=>T[37];for(let T=0;T<$e.length;T+=1){let F=et(e,$e,T),W=He(F);ue.set(W,O[T]=$t(W,F))}const Je=[Vl,Sl],he=[];function Xe(T,F){return T[25].block?0:1}return P=Xe(e),$=he[P]=Je[P](e),{key:s,first:null,c(){t=E("div"),l=E("div"),n=E("div"),a=R(),r=E("h2"),o=S("Round "),f=S(i),u=R(),d=E("div"),p=R(),c=E("div"),U&&U.c(),y=R();for(let T=0;T<G.length;T+=1)G[T].c();g=R(),b=E("div"),h=E("div"),_=E("button"),v=E("span"),q=S(`
            Block Activity `),ee&&ee.c(),B=R(),M=E("div"),z=E("div"),K=S(`🎁 Resupply everyone for
            `);for(let T=0;T<O.length;T+=1)O[T].c();le=R(),$.c(),w=R(),this.h()},l(T){t=A(T,"DIV",{class:!0,id:!0});var F=D(t);l=A(F,"DIV",{class:!0});var W=D(l);n=A(W,"DIV",{class:!0}),D(n).forEach(m),a=L(W),r=A(W,"H2",{class:!0});var Y=D(r);o=V(Y,"Round "),f=V(Y,i),Y.forEach(m),u=L(W),d=A(W,"DIV",{class:!0}),D(d).forEach(m),W.forEach(m),p=L(F),c=A(F,"DIV",{class:!0});var pe=D(c);U&&U.l(pe),y=L(pe);for(let ve=0;ve<G.length;ve+=1)G[ve].l(pe);pe.forEach(m),g=L(F),b=A(F,"DIV",{class:!0});var we=D(b);h=A(we,"DIV",{class:!0});var Qe=D(h);_=A(Qe,"BUTTON",{class:!0});var De=D(_);v=A(De,"SPAN",{class:!0}),D(v).forEach(m),q=V(De,`
            Block Activity `),ee&&ee.l(De),De.forEach(m),Qe.forEach(m),B=L(we),M=A(we,"DIV",{class:!0});var Ne=D(M);z=A(Ne,"DIV",{class:!0});var je=D(z);K=V(je,`🎁 Resupply everyone for
            `);for(let ve=0;ve<O.length;ve+=1)O[ve].l(je);je.forEach(m),le=L(Ne),$.l(Ne),Ne.forEach(m),we.forEach(m),w=L(F),F.forEach(m),this.h()},h(){I(n,"class","left svelte-10qxq0u"),I(r,"class","title svelte-10qxq0u"),I(d,"class","right svelte-10qxq0u"),I(l,"class","round-header svelte-10qxq0u"),I(c,"class","summary svelte-10qxq0u"),I(v,"class","custom prefix svelte-10qxq0u"),I(_,"class","svelte-10qxq0u"),I(h,"class","expand custom svelte-10qxq0u"),I(z,"class","income step svelte-10qxq0u"),I(M,"class","steps svelte-10qxq0u"),I(b,"class","block svelte-10qxq0u"),H(b,"expanded",e[2][e[27]]),I(t,"class","round svelte-10qxq0u"),I(t,"id",Q=`round-${e[27]+1}`),this.first=t},m(T,F){N(T,t,F),k(t,l),k(l,n),k(l,a),k(l,r),k(r,o),k(r,f),k(l,u),k(l,d),k(t,p),k(t,c),U&&U.m(c,null),k(c,y);for(let W=0;W<G.length;W+=1)G[W]&&G[W].m(c,null);k(t,g),k(t,b),k(b,h),k(h,_),k(_,v),k(_,q),ee&&ee.m(_,null),k(b,B),k(b,M),k(M,z),k(z,K);for(let W=0;W<O.length;W+=1)O[W]&&O[W].m(z,null);k(M,le),he[P].m(M,null),k(t,w),te=!0,x||(ie=fe(_,"click",Tt),x=!0)},p(T,F){if(e=T,(!te||F[0]&1)&&i!==(i=e[27]+1+"")&&J(f,i),e[25].market?U?U.p(e,F):(U=vt(e),U.c(),U.m(c,y)):U&&(U.d(1),U=null),F[0]&17){se=X(St(e[25].balances,e[20]));let Y;for(Y=0;Y<se.length;Y+=1){const pe=tt(e,se,Y);G[Y]?(G[Y].p(pe,F),C(G[Y],1)):(G[Y]=Et(pe),G[Y].c(),C(G[Y],1),G[Y].m(c,null))}for(ce(),Y=se.length;Y<G.length;Y+=1)jt(Y);_e()}e[25].block?ee?ee.p(e,F):(ee=At(e),ee.c(),ee.m(_,null)):ee&&(ee.d(1),ee=null),F[0]&17&&($e=X(e[25].resupply[0]),O=Ve(O,F,He,1,e,$e,ue,z,Jt,$t,null,et));let W=P;P=Xe(e),P===W?he[P].p(e,F):(ce(),j(he[W],1,1,()=>{he[W]=null}),_e(),$=he[P],$?$.p(e,F):($=he[P]=Je[P](e),$.c()),C($,1),$.m(M,null)),(!te||F[0]&5)&&H(b,"expanded",e[2][e[27]]),(!te||F[0]&1&&Q!==(Q=`round-${e[27]+1}`))&&I(t,"id",Q)},i(T){if(!te){for(let F=0;F<se.length;F+=1)C(G[F]);C($),te=!0}},o(T){G=G.filter(Boolean);for(let F=0;F<G.length;F+=1)j(G[F]);j($),te=!1},d(T){T&&m(t),U&&U.d(),me(G,T),ee&&ee.d();for(let F=0;F<O.length;F+=1)O[F].d();he[P].d(),x=!1,ie()}}}function Bl(s){let e,t,l,n;const a=[pl,ml,hl],r=[];function o(i,f){return i[0]instanceof Promise?0:i[0]instanceof Error?1:i[0]?2:-1}return~(e=o(s))&&(t=r[e]=a[e](s)),{c(){t&&t.c(),l=Ie()},l(i){t&&t.l(i),l=Ie()},m(i,f){~e&&r[e].m(i,f),N(i,l,f),n=!0},p(i,f){let u=e;e=o(i),e===u?~e&&r[e].p(i,f):(t&&(ce(),j(r[u],1,1,()=>{r[u]=null}),_e()),~e?(t=r[e],t?t.p(i,f):(t=r[e]=a[e](i),t.c()),C(t,1),t.m(l.parentNode,l)):t=null)},i(i){n||(C(t),n=!0)},o(i){j(t),n=!1},d(i){i&&m(l),~e&&r[e].d(i)}}}function Ml(s){let e,t;return e=new Zt({props:{title:"Match Details",$$slots:{default:[Bl]},$$scope:{ctx:s}}}),{c(){ne(e.$$.fragment)},l(l){ae(e.$$.fragment,l)},m(l,n){re(e,l,n),t=!0},p(l,n){const a={};n[0]&15|n[1]&67108864&&(a.$$scope={dirty:n,ctx:l}),e.$set(a)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){oe(e,l)}}}const Cl=/(\.?0+(e[-+]\d+)|\.?0+)$/;function Rl(s){var o,i;const e=s.filter(f=>f.event==="create_player_failed").map(f=>f.player),t=s.findIndex(f=>f.event==="game_created"),l=s.findIndex(f=>f.event==="market_initialized"),n=l!==-1?s[l].reserves.map(f=>Number(f)/1e18):void 0,a=s[t].players,r=[];for(let f=t+1;f<s.length;){const u=Ue("round_played",s,f)+1;if(u<=f)break;const d=Ll({playerCount:a.length,logs:s,start:f,end:u,lastRoundBalances:((o=r[r.length-1])==null?void 0:o.balances)??void 0,lastRoundMarketBalances:((i=r[r.length-1])==null?void 0:i.market)??n});r.push(d),f=u}return{rounds:r,players:a,undeployedPlayers:e}}function Ll(s){const{playerCount:e,start:t,end:l,logs:n}=s,a=Te(e),r=s.lastRoundBalances??Te(e),o=s.lastRoundMarketBalances?s.lastRoundMarketBalances.slice():void 0,i=s.lastRoundBalances?s.lastRoundBalances.slice().map(c=>c.slice()):Te(e);let f=t;for(;f<l;++f){const c=n[f];if(c.event==="mint"){const y=Number(c.assetAmount)/1e18;a[c.playerIdx][c.assetIdx]+=y,i[c.playerIdx][c.assetIdx]+=y}else break}let u=null;const d=Ue("block_built",n,f,l);if(d!==-1){const c=Pt(e),y=n[d].builderIdx;for(;f<d;++f){const b=n[f];if(b.event==="block_bid")c[b.builderIdx]=Number(b.bid)/1e18;else if(b.event==="build_block_failed")c[b.builderIdx]=NaN;else break}const g=[];for(;f<d;++f){const b=n[f];if(b.event==="swap"&&b.fromAmount!=="0"){const h={playerIdx:b.playerIdx,fromAmount:Number(b.fromAmount)/1e18,toAmount:Number(b.toAmount)/1e18,fromAssetIdx:b.fromAssetIdx,toAssetIdx:b.toAssetIdx};g.push(h),i[h.playerIdx][h.fromAssetIdx]-=h.fromAmount,i[h.playerIdx][h.toAssetIdx]+=h.toAmount,o&&(o[h.fromAssetIdx]+=h.fromAmount,o[h.toAssetIdx]-=h.toAmount)}}i[y][0]-=c[y],u={bids:c,builderIdx:y,swaps:g}}else if(f=Ue("empty_block",n,f,l),f===-1)throw new Error("Parse error: Expected empty block");const p=Pt(e);for(let c=t;c<l;++c){const y=n[c];if(y.event!=="leaked")continue;const g=Number(y.assetAmount)/1e18;o&&(o[y.assetIdx]-=g),p[y.assetIdx]=g}return{market:o,leaks:p,resupply:a,block:u,balances:i,balanceDeltas:i.map((c,y)=>c.map((g,b)=>g-r[y][b]))}}function Pt(s){return[...new Array(s)].fill(0)}function Te(s){return[...new Array(s)].map(()=>[...new Array(s)].fill(0))}function Ue(s,e,t,l){l=Math.min(e.length,l??e.length);let n=t;for(;n<l;++n)if(e[n].event===s)return n;return-1}function Z(s){let e="0";return s===0?e:(Math.abs(s)>1e-5?e=s.toFixed(4):e=s.toExponential(4),e.replace(Cl,"$2"))}function Be(s){const e=Z(s);return s<0?e:`+${e}`}function St(s,e){const t=s.map(e);return s.map((l,n)=>n).sort((l,n)=>t[l]-t[n])}function Vt(s){const e=[];let t=null;for(const l of s)(!t||t.playerIdx!==l.playerIdx)&&(t={playerIdx:l.playerIdx,swaps:[]},e.push(t)),t.swaps.push(l);return e}const Bt=s=>s.balances.map(e=>e.slice(1));function Fl(s,e,t){let l;de(s,Xt,P=>t(9,l=P));const n=["🪙","🍅","🍞","🐟️","🥕","👕"];let a,r,o,i,f,u;const d=Yt(P=>t(0,u=P));let p=[],c=null;function y(P){t(5,a=P.get("tournament")??void 0),t(6,r=Number(P.get("season")??"1")-1),t(7,o=Number(P.get("bracket")??"1")-1),t(1,f=Number(P.get("idx")??NaN)),isNaN(f)?t(1,f=void 0):t(1,f-=1),t(8,i=P.get("match")??void 0)}function g(P){return n[P]??"?"}const b=(P,$,w)=>({x:w,y:Math.max(...$.balances[P.idx].slice(1))}),h=P=>t(3,c=P),_=()=>t(3,c=null),v=P=>t(3,c=P),q=()=>t(3,c=null),B=(P,$,w,Q)=>w>=P[$+1]?Q:$,M=P=>t(3,c=P),z=()=>t(3,c=null),K=P=>t(3,c=P),O=()=>t(3,c=null),ue=P=>-Math.max(...P),le=P=>t(2,p[P]=!p[P],p);return s.$$.update=()=>{s.$$.dirty[0]&512&&y(l.url.searchParams),s.$$.dirty[0]&480&&(a&&r!==void 0&&o!==void 0&&i?d(async()=>{const P=await fetch(`${Wt}/results/match?${new URLSearchParams({tournament:a,season:r.toString(),bracket:o.toString(),id:i.toString()})}`);if(!P.ok)throw console.error(await P.text()),new Error(P.statusText);const $=await P.json(),{rounds:w,players:Q,undeployedPlayers:te}=Rl(JSON.parse($.logs));return{tournamentId:$.tournamentId,season:$.season,type:$.type,bracket:$.bracket,duration:$.duration,players:Q.map((x,ie)=>({...$.players.find(U=>U.address===x),idx:ie,scoreAssetIdx:w[w.length-1].balances[ie].slice(1).map((U,se)=>[se,U]).sort((U,se)=>se[1]-U[1]).map(([U])=>U)[0]+1})),undeployedPlayers:te.map(x=>$.players.find(ie=>ie.address===x).name),time:new Date($.time),rounds:w,winnerIdx:Q.findIndex(x=>x===$.players[0].address)}}):t(0,u=new Qt("Not found"))),s.$$.dirty[0]&1&&(u&&!(u instanceof Promise)&&!(u instanceof Error)?t(2,p=[...new Array(u.rounds.length)].map(()=>!1)):t(2,p=[]))},[u,f,p,c,g,a,r,o,i,l,b,h,_,v,q,B,M,z,K,O,ue,le]}class Xl extends qe{constructor(e){super(),Ee(this,e,Fl,Ml,ye,{},null,[-1,-1])}}export{Xl as component};
