import{s as Fe,o as Be,p as x,k as E,i as u,b as U,e as D,t as w,j as T,d as P,f as N,q as $e,h as y,v as I,l as g,w as ke,x as Ue,m as G,n as Ne}from"../chunks/scheduler.C1FoT2GD.js";import{S as Te,i as He,c as le,b as ae,m as re,t as H,a as R,d as se,g as ie,e as ce}from"../chunks/index.DFmxPlw4.js";import{e as ee,u as _e,o as he}from"../chunks/each.Bmx-BImQ.js";import{b as te}from"../chunks/paths.DOnYZ1f4.js";import{p as Oe}from"../chunks/stores.ZuLyBo9H.js";import{P as Re,c as je,g as be,f as Ee}from"../chunks/kit.B5hTzwHX.js";import{P as qe,L as Ge,C as Ve}from"../chunks/page.CWCv2ozC.js";import{P as Ae}from"../chunks/player.rNBuc2kc.js";function Ie(o,e,t){const l=o.slice();return l[9]=e[t],l[11]=t,l}function we(o,e,t){const l=o.slice();return l[12]=e[t],l}function ye(o,e,t){const l=o.slice();return l[12]=e[t],l}function ze(o){let e,t,l,s,i="Bracket Ranking",r,n,a=[],_=new Map,d,h,k,A="Matches",F,V,L,C,M=o[0].rankings.length+"",j,p,m=o[0].matches.length+"",$,v,b=o[0].matches.length/Math.ceil(o[0].rankings.length/4)+"",q,X,Q,O,Y,J,B=[],me=new Map,K,ue,de;e=new Ge({props:{$$slots:{default:[Xe]},$$scope:{ctx:o}}});let ne=ee(o[0].rankings);const pe=c=>c[12].address;for(let c=0;c<ne.length;c+=1){let f=ye(o,ne,c),S=pe(f);_.set(S,a[c]=De(S,f))}let oe=ee(o[0].matches);const ge=c=>c[9].id;for(let c=0;c<oe.length;c+=1){let f=Ie(o,oe,c),S=ge(f);me.set(S,B[c]=Le(S,f))}return{c(){le(e.$$.fragment),t=U(),l=D("section"),s=D("h2"),s.textContent=i,r=U(),n=D("ol");for(let c=0;c<a.length;c+=1)a[c].c();d=U(),h=D("section"),k=D("h2"),k.textContent=A,F=U(),V=D("div"),L=D("div"),C=w("Players: "),j=w(M),p=w(`,
        Matches: `),$=w(m),v=w(`
        (`),q=w(b),X=w("pp)"),Q=U(),O=D("input"),Y=U(),J=D("div");for(let c=0;c<B.length;c+=1)B[c].c();this.h()},l(c){ae(e.$$.fragment,c),t=T(c),l=P(c,"SECTION",{class:!0});var f=N(l);s=P(f,"H2",{class:!0,"data-svelte-h":!0}),$e(s)!=="svelte-3niir0"&&(s.textContent=i),r=T(f),n=P(f,"OL",{});var S=N(n);for(let W=0;W<a.length;W+=1)a[W].l(S);S.forEach(u),f.forEach(u),d=T(c),h=P(c,"SECTION",{class:!0});var Z=N(h);k=P(Z,"H2",{class:!0,"data-svelte-h":!0}),$e(k)!=="svelte-xzp5ah"&&(k.textContent=A),F=T(Z),V=P(Z,"DIV",{class:!0});var fe=N(V);L=P(fe,"DIV",{});var z=N(L);C=y(z,"Players: "),j=y(z,M),p=y(z,`,
        Matches: `),$=y(z,m),v=y(z,`
        (`),q=y(z,b),X=y(z,"pp)"),z.forEach(u),Q=T(fe),O=P(fe,"INPUT",{type:!0,class:!0,placeholder:!0}),fe.forEach(u),Y=T(Z),J=P(Z,"DIV",{class:!0});var ve=N(J);for(let W=0;W<B.length;W+=1)B[W].l(ve);ve.forEach(u),Z.forEach(u),this.h()},h(){I(s,"class","svelte-agtccm"),I(l,"class","svelte-agtccm"),I(k,"class","svelte-agtccm"),I(O,"type","text"),I(O,"class","filter svelte-agtccm"),I(O,"placeholder","username"),I(V,"class","summary svelte-agtccm"),I(J,"class","matches-grid svelte-agtccm"),I(h,"class","matches svelte-agtccm")},m(c,f){re(e,c,f),E(c,t,f),E(c,l,f),g(l,s),g(l,r),g(l,n);for(let S=0;S<a.length;S+=1)a[S]&&a[S].m(n,null);E(c,d,f),E(c,h,f),g(h,k),g(h,F),g(h,V),g(V,L),g(L,C),g(L,j),g(L,p),g(L,$),g(L,v),g(L,q),g(L,X),g(V,Q),g(V,O),ke(O,o[1]),g(h,Y),g(h,J);for(let S=0;S<B.length;S+=1)B[S]&&B[S].m(J,null);K=!0,ue||(de=Ue(O,"input",o[6]),ue=!0)},p(c,f){const S={};f&131073&&(S.$$scope={dirty:f,ctx:c}),e.$set(S),f&1&&(ne=ee(c[0].rankings),ie(),a=_e(a,f,pe,1,c,ne,_,n,he,De,null,ye),ce()),(!K||f&1)&&M!==(M=c[0].rankings.length+"")&&G(j,M),(!K||f&1)&&m!==(m=c[0].matches.length+"")&&G($,m),(!K||f&1)&&b!==(b=c[0].matches.length/Math.ceil(c[0].rankings.length/4)+"")&&G(q,b),f&2&&O.value!==c[1]&&ke(O,c[1]),f&3&&(oe=ee(c[0].matches),ie(),B=_e(B,f,ge,1,c,oe,me,J,he,Le,null,Ie),ce())},i(c){if(!K){H(e.$$.fragment,c);for(let f=0;f<ne.length;f+=1)H(a[f]);for(let f=0;f<oe.length;f+=1)H(B[f]);K=!0}},o(c){R(e.$$.fragment,c);for(let f=0;f<a.length;f+=1)R(a[f]);for(let f=0;f<B.length;f+=1)R(B[f]);K=!1},d(c){c&&(u(t),u(l),u(d),u(h)),se(e,c);for(let f=0;f<a.length;f+=1)a[f].d();for(let f=0;f<B.length;f+=1)B[f].d();ue=!1,de()}}}function Qe(o){let e,t,l,s=be(o[0])+"",i,r;return e=new Ve({props:{failed:!0}}),{c(){le(e.$$.fragment),t=U(),l=D("div"),i=w(s),this.h()},l(n){ae(e.$$.fragment,n),t=T(n),l=P(n,"DIV",{class:!0});var a=N(l);i=y(a,s),a.forEach(u),this.h()},h(){I(l,"class","error")},m(n,a){re(e,n,a),E(n,t,a),E(n,l,a),g(l,i),r=!0},p(n,a){(!r||a&1)&&s!==(s=be(n[0])+"")&&G(i,s)},i(n){r||(H(e.$$.fragment,n),r=!0)},o(n){R(e.$$.fragment,n),r=!1},d(n){n&&(u(t),u(l)),se(e,n)}}}function Je(o){let e,t,l;return t=new Ve({}),{c(){e=D("div"),le(t.$$.fragment),this.h()},l(s){e=P(s,"DIV",{class:!0});var i=N(e);ae(t.$$.fragment,i),i.forEach(u),this.h()},h(){I(e,"class","loading")},m(s,i){E(s,e,i),re(t,e,null),l=!0},p:Ne,i(s){l||(H(t.$$.fragment,s),l=!0)},o(s){R(t.$$.fragment,s),l=!1},d(s){s&&u(e),se(t)}}}function Ke(o){let e;return{c(){e=w("Grand Faire")},l(t){e=y(t,"Grand Faire")},m(t,l){E(t,e,l)},d(t){t&&u(e)}}}function We(o){let e;return{c(){e=w("Market Day")},l(t){e=y(t,"Market Day")},m(t,l){E(t,e,l)},d(t){t&&u(e)}}}function Xe(o){let e,t,l=o[0].bracket+1+"",s,i,r,n=o[0].time.toLocaleString()+"",a,_,d,h,k,A=o[0].season+1+"",F,V,L,C,M,j;function p(v,b){return v[0].type=="scrimmage"?We:Ke}let m=p(o),$=m(o);return{c(){e=D("h1"),t=w("Bracket "),s=w(l),i=U(),r=D("div"),a=w(n),_=U(),d=D("div"),h=D("a"),k=w("Season "),F=w(A),L=U(),C=D("div"),M=D("a"),$.c(),this.h()},l(v){e=P(v,"H1",{class:!0});var b=N(e);t=y(b,"Bracket "),s=y(b,l),b.forEach(u),i=T(v),r=P(v,"DIV",{class:!0});var q=N(r);a=y(q,n),q.forEach(u),_=T(v),d=P(v,"DIV",{});var X=N(d);h=P(X,"A",{href:!0,class:!0});var Q=N(h);k=y(Q,"Season "),F=y(Q,A),Q.forEach(u),X.forEach(u),L=T(v),C=P(v,"DIV",{});var O=N(C);M=P(O,"A",{href:!0,class:!0});var Y=N(M);$.l(Y),Y.forEach(u),O.forEach(u),this.h()},h(){I(e,"class","svelte-agtccm"),I(r,"class","date"),I(h,"href",V=`${te}/season?&season=${o[0].season+1}`),I(h,"class","svelte-agtccm"),I(M,"href",j=`${te}/tournament?id=${o[0].tournamentId}&season=${o[0].season+1}`),I(M,"class","svelte-agtccm")},m(v,b){E(v,e,b),g(e,t),g(e,s),E(v,i,b),E(v,r,b),g(r,a),E(v,_,b),E(v,d,b),g(d,h),g(h,k),g(h,F),E(v,L,b),E(v,C,b),g(C,M),$.m(M,null)},p(v,b){b&1&&l!==(l=v[0].bracket+1+"")&&G(s,l),b&1&&n!==(n=v[0].time.toLocaleString()+"")&&G(a,n),b&1&&A!==(A=v[0].season+1+"")&&G(F,A),b&1&&V!==(V=`${te}/season?&season=${v[0].season+1}`)&&I(h,"href",V),m!==(m=p(v))&&($.d(1),$=m(v),$&&($.c(),$.m(M,null))),b&1&&j!==(j=`${te}/tournament?id=${v[0].tournamentId}&season=${v[0].season+1}`)&&I(M,"href",j)},d(v){v&&(u(e),u(i),u(r),u(_),u(d),u(L),u(C)),$.d()}}}function De(o,e){let t,l,s,i=Ee(e[12].score)+"",r,n,a;return l=new Ae({props:{name:e[12].name}}),{key:o,first:null,c(){t=D("li"),le(l.$$.fragment),s=w(`:
        `),r=w(i),n=U(),this.h()},l(_){t=P(_,"LI",{});var d=N(t);ae(l.$$.fragment,d),s=y(d,`:
        `),r=y(d,i),n=T(d),d.forEach(u),this.h()},h(){this.first=t},m(_,d){E(_,t,d),re(l,t,null),g(t,s),g(t,r),g(t,n),a=!0},p(_,d){e=_;const h={};d&1&&(h.name=e[12].name),l.$set(h),(!a||d&1)&&i!==(i=Ee(e[12].score)+"")&&G(r,i)},i(_){a||(H(l.$$.fragment,_),a=!0)},o(_){R(l.$$.fragment,_),a=!1},d(_){_&&u(t),se(l)}}}function Pe(o){let e,t,l,s=o[11]+1+"",i,r,n,a,_,d,h=[],k=new Map,A,F;function V(p,m){return p[9].rounds!==void 0?Ze:Ye}let L=V(o),C=L(o),M=ee(o[9].rankings);const j=p=>p[12].address;for(let p=0;p<M.length;p+=1){let m=we(o,M,p),$=j(m);k.set($,h[p]=Ce($,m))}return{c(){e=D("div"),t=D("h3"),l=w("Match "),i=w(s),r=U(),n=D("a"),C.c(),_=U(),d=D("ol");for(let p=0;p<h.length;p+=1)h[p].c();A=U(),this.h()},l(p){e=P(p,"DIV",{class:!0});var m=N(e);t=P(m,"H3",{class:!0});var $=N(t);l=y($,"Match "),i=y($,s),r=T($),n=P($,"A",{class:!0,href:!0});var v=N(n);C.l(v),v.forEach(u),$.forEach(u),_=T(m),d=P(m,"OL",{class:!0});var b=N(d);for(let q=0;q<h.length;q+=1)h[q].l(b);b.forEach(u),A=T(m),m.forEach(u),this.h()},h(){I(n,"class","smaller svelte-agtccm"),I(n,"href",a=`${te}/match?tournament=${o[0].tournamentId}&season=${o[0].season+1}&bracket=${o[0].bracket+1}&match=${o[9].id}&idx=${o[11]+1}`),I(t,"class","svelte-agtccm"),I(d,"class","svelte-agtccm"),I(e,"class","match svelte-agtccm")},m(p,m){E(p,e,m),g(e,t),g(t,l),g(t,i),g(t,r),g(t,n),C.m(n,null),g(e,_),g(e,d);for(let $=0;$<h.length;$+=1)h[$]&&h[$].m(d,null);g(e,A),F=!0},p(p,m){(!F||m&1)&&s!==(s=p[11]+1+"")&&G(i,s),L===(L=V(p))&&C?C.p(p,m):(C.d(1),C=L(p),C&&(C.c(),C.m(n,null))),(!F||m&1&&a!==(a=`${te}/match?tournament=${p[0].tournamentId}&season=${p[0].season+1}&bracket=${p[0].bracket+1}&match=${p[9].id}&idx=${p[11]+1}`))&&I(n,"href",a),m&1&&(M=ee(p[9].rankings),ie(),h=_e(h,m,j,1,p,M,k,d,he,Ce,null,we),ce())},i(p){if(!F){for(let m=0;m<M.length;m+=1)H(h[m]);F=!0}},o(p){for(let m=0;m<h.length;m+=1)R(h[m]);F=!1},d(p){p&&u(e),C.d();for(let m=0;m<h.length;m+=1)h[m].d()}}}function Ye(o){let e;return{c(){e=w("(details)")},l(t){e=y(t,"(details)")},m(t,l){E(t,e,l)},p:Ne,d(t){t&&u(e)}}}function Ze(o){let e,t=o[9].rounds+"",l,s;return{c(){e=w("("),l=w(t),s=w("/32 rounds)")},l(i){e=y(i,"("),l=y(i,t),s=y(i,"/32 rounds)")},m(i,r){E(i,e,r),E(i,l,r),E(i,s,r)},p(i,r){r&1&&t!==(t=i[9].rounds+"")&&G(l,t)},d(i){i&&(u(e),u(l),u(s))}}}function Ce(o,e){let t,l,s,i=e[12].score.toFixed(3)+"",r,n;return l=new Ae({props:{name:e[12].name}}),{key:o,first:null,c(){t=D("li"),le(l.$$.fragment),s=w(`:
            `),r=w(i),this.h()},l(a){t=P(a,"LI",{});var _=N(t);ae(l.$$.fragment,_),s=y(_,`:
            `),r=y(_,i),_.forEach(u),this.h()},h(){this.first=t},m(a,_){E(a,t,_),re(l,t,null),g(t,s),g(t,r),n=!0},p(a,_){e=a;const d={};_&1&&(d.name=e[12].name),l.$set(d),(!n||_&1)&&i!==(i=e[12].score.toFixed(3)+"")&&G(r,i)},i(a){n||(H(l.$$.fragment,a),n=!0)},o(a){R(l.$$.fragment,a),n=!1},d(a){a&&u(t),se(l)}}}function Le(o,e){let t,l=Me(e[1],e[9].rankings.map(Se)),s,i,r=l&&Pe(e);return{key:o,first:null,c(){t=x(),r&&r.c(),s=x(),this.h()},l(n){t=x(),r&&r.l(n),s=x(),this.h()},h(){this.first=t},m(n,a){E(n,t,a),r&&r.m(n,a),E(n,s,a),i=!0},p(n,a){e=n,a&3&&(l=Me(e[1],e[9].rankings.map(Se))),l?r?(r.p(e,a),a&3&&H(r,1)):(r=Pe(e),r.c(),H(r,1),r.m(s.parentNode,s)):r&&(ie(),R(r,1,1,()=>{r=null}),ce())},i(n){i||(H(r),i=!0)},o(n){R(r),i=!1},d(n){n&&(u(t),u(s)),r&&r.d(n)}}}function xe(o){let e,t,l,s;const i=[Je,Qe,ze],r=[];function n(a,_){return a[0]instanceof Promise?0:a[0]instanceof Error?1:a[0]?2:-1}return~(e=n(o))&&(t=r[e]=i[e](o)),{c(){t&&t.c(),l=x()},l(a){t&&t.l(a),l=x()},m(a,_){~e&&r[e].m(a,_),E(a,l,_),s=!0},p(a,_){let d=e;e=n(a),e===d?~e&&r[e].p(a,_):(t&&(ie(),R(r[d],1,1,()=>{r[d]=null}),ce()),~e?(t=r[e],t?t.p(a,_):(t=r[e]=i[e](a),t.c()),H(t,1),t.m(l.parentNode,l)):t=null)},i(a){s||(H(t),s=!0)},o(a){R(t),s=!1},d(a){a&&u(l),~e&&r[e].d(a)}}}function et(o){let e,t;return e=new qe({props:{title:"Bracket Details",$$slots:{default:[xe]},$$scope:{ctx:o}}}),{c(){le(e.$$.fragment)},l(l){ae(e.$$.fragment,l)},m(l,s){re(e,l,s),t=!0},p(l,[s]){const i={};s&131075&&(i.$$scope={dirty:s,ctx:l}),e.$set(i)},i(l){t||(H(e.$$.fragment,l),t=!0)},o(l){R(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function Me(o,e){const t=(o??"").replaceAll(/\s/g,"");return t?e.some(l=>l.toLocaleLowerCase().includes(t)):!0}const Se=o=>o.name;function tt(o,e,t){let l;Be(o,Oe,k=>t(5,l=k));let s,i,r,n;const a=je(k=>t(0,n=k));let _=null;function d(k){t(2,s=k.get("tournament")??void 0),t(3,i=Number(k.get("season")??"1")-1),t(4,r=Number(k.get("bracket")??"1")-1)}function h(){_=this.value,t(1,_)}return o.$$.update=()=>{o.$$.dirty&32&&d(l.url.searchParams),o.$$.dirty&28&&(s&&i!==void 0&&r!==void 0?a(async()=>{const k=await fetch(`${Re}/results/bracket?${new URLSearchParams({tournament:s,season:i.toString(),bracket:r.toString()})}`);if(!k.ok)throw console.error(await k.text()),new Error(k.statusText);const A=await k.json();return{...A,time:new Date(A.time)}}):t(0,n=new Error("Not Found")))},[n,_,s,i,r,l,h]}class ft extends Te{constructor(e){super(),He(this,e,tt,et,Fe,{})}}export{ft as component};
